/*! For license information please see 9142.38666818a55cfaef1121.js.LICENSE.txt */
(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[9142],{84102:(e,o,t)=>{"use strict";t.d(o,{Z:()=>s});var r=t(94015);var n=t.n(r);var i=t(23645);var l=t.n(i);var a=l()(n());a.push([e.id,".sp-Grid {\n    color: var(--jp-ui-font-color0);\n    background-color: var(--jp-rendermime-table-row-background);\n}\n\n.sp-GridHeader {\n    font-weight: bold;\n    background-color: var(--jp-border-color2);\n    color: var(--jp-ui-font-color0);\n}\n\n.sp-Row-Index {\n    border-right-style: solid;\n    background-color: var(--jp-border-color2);\n}\n\n.sp-Cell {\n    white-space: pre;\n}\n\n.sp-Cell-Number {\n    text-align: end;\n}\n\n.sp-Cell-Error {\n    font-weight: bold;\n    color: red;\n}\n\n.sp-Cell-MergeDown {\n    border-bottom-color: transparent;\n}","",{version:3,sources:["webpack://./node_modules/jupyterlab-spreadsheet/style/grid.css"],names:[],mappings:"AAAA;IACI,+BAA+B;IAC/B,2DAA2D;AAC/D;;AAEA;IACI,iBAAiB;IACjB,yCAAyC;IACzC,+BAA+B;AACnC;;AAEA;IACI,yBAAyB;IACzB,yCAAyC;AAC7C;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,iBAAiB;IACjB,UAAU;AACd;;AAEA;IACI,gCAAgC;AACpC",sourcesContent:[".sp-Grid {\n    color: var(--jp-ui-font-color0);\n    background-color: var(--jp-rendermime-table-row-background);\n}\n\n.sp-GridHeader {\n    font-weight: bold;\n    background-color: var(--jp-border-color2);\n    color: var(--jp-ui-font-color0);\n}\n\n.sp-Row-Index {\n    border-right-style: solid;\n    background-color: var(--jp-border-color2);\n}\n\n.sp-Cell {\n    white-space: pre;\n}\n\n.sp-Cell-Number {\n    text-align: end;\n}\n\n.sp-Cell-Error {\n    font-weight: bold;\n    color: red;\n}\n\n.sp-Cell-MergeDown {\n    border-bottom-color: transparent;\n}"],sourceRoot:""}]);const s=a},89523:(e,o,t)=>{"use strict";t.d(o,{Z:()=>s});var r=t(94015);var n=t.n(r);var i=t(23645);var l=t.n(i);var a=l()(n());a.push([e.id,".sp-SpreadsheetWidget > .p-TabBar {\n    height: 26px;\n    background-color: var(--jp-border-color1);\n    padding-left: 10px;\n}\n\n.sp-SpreadsheetWidget > .p-TabBar .p-TabBar-tab {\n    padding: 0 0.5em;\n    background-color: var(--jp-layout-color2);\n    border: 1px solid var(--jp-border-color1);\n    border-left: 0px;\n    border-bottom: 0px;\n    color: var(--jp-ui-font-color0);\n}\n\n.sp-SpreadsheetWidget > .p-TabBar .p-TabBar-tab.p-mod-current {\n    background-color: var(--jp-layout-color0);\n    border-top: 0px;\n    border-bottom: 2px solid var(--jp-brand-color0);\n}","",{version:3,sources:["webpack://./node_modules/jupyterlab-spreadsheet/style/widget.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,yCAAyC;IACzC,kBAAkB;AACtB;;AAEA;IACI,gBAAgB;IAChB,yCAAyC;IACzC,yCAAyC;IACzC,gBAAgB;IAChB,kBAAkB;IAClB,+BAA+B;AACnC;;AAEA;IACI,yCAAyC;IACzC,eAAe;IACf,+CAA+C;AACnD",sourcesContent:[".sp-SpreadsheetWidget > .p-TabBar {\n    height: 26px;\n    background-color: var(--jp-border-color1);\n    padding-left: 10px;\n}\n\n.sp-SpreadsheetWidget > .p-TabBar .p-TabBar-tab {\n    padding: 0 0.5em;\n    background-color: var(--jp-layout-color2);\n    border: 1px solid var(--jp-border-color1);\n    border-left: 0px;\n    border-bottom: 0px;\n    color: var(--jp-ui-font-color0);\n}\n\n.sp-SpreadsheetWidget > .p-TabBar .p-TabBar-tab.p-mod-current {\n    background-color: var(--jp-layout-color0);\n    border-top: 0px;\n    border-bottom: 2px solid var(--jp-brand-color0);\n}"],sourceRoot:""}]);const s=a},77050:(e,o,t)=>{"use strict";t.d(o,{Z:()=>p});var r=t(94015);var n=t.n(r);var i=t(23645);var l=t.n(i);var a=t(61667);var s=t.n(a);var d=t(80746);var c=t(56075);var u=l()(n());var f=s()(d.Z);var h=s()(c.Z);u.push([e.id,"/*\r\nIMPORTANT:\r\nIn order to preserve the uniform grid appearance, all cell styles need to have padding, margin and border sizes.\r\nNo built-in (selected, editable, highlight, flashing, invalid, loading, :focus) or user-specified CSS\r\nclasses should alter those!\r\n*/\r\n\r\n.slick-header.ui-state-default, .slick-headerrow.ui-state-default, .slick-footerrow.ui-state-default, .slick-top-panel-scroller.ui-state-default, .slick-group-header.ui-state-default {\r\n  width: 100%;\r\n  overflow: auto;\r\n  position: relative;\r\n  border-left: 0px !important;\r\n}\r\n\r\n.slick-header.ui-state-default {\r\n  overflow: inherit;\r\n}\r\n\r\n.slick-header::-webkit-scrollbar,  .slick-headerrow::-webkit-scrollbar, .slick-footerrow::-webkit-scrollbar {\r\n  display: none\r\n}\r\n\r\n.slick-header-columns, .slick-headerrow-columns, .slick-footerrow-columns, .slick-group-header-columns {\r\n  position: relative;\r\n  white-space: nowrap;\r\n  cursor: default;\r\n  overflow: hidden;\r\n}\r\n\r\n.slick-header-column.ui-state-default, .slick-group-header-column.ui-state-default {\r\n  position: relative;\r\n  display: inline-block;\r\n  box-sizing: content-box !important; /* this here only for Firefox! */ \r\n  overflow: hidden;\r\n  -o-text-overflow: ellipsis;\r\n  text-overflow: ellipsis;\r\n  height: 16px;\r\n  line-height: 16px;\r\n  margin: 0;\r\n  padding: 4px;\r\n  border-right: 1px solid silver;\r\n  border-left: 0px !important;\r\n  border-top: 0px !important;\r\n  border-bottom: 0px !important;\r\n  float: left;\r\n}\r\n\r\n.slick-footerrow-column.ui-state-default {\r\n  -o-text-overflow: ellipsis;\r\n  text-overflow: ellipsis;\r\n  margin: 0;\r\n  padding: 4px;\r\n  border-right: 1px solid silver;\r\n  border-left: 0px;\r\n  border-top: 0px;\r\n  border-bottom: 0px;\r\n  float: left;\r\n  line-height: 20px;\r\n  vertical-align: middle;\r\n}\r\n\r\n.slick-headerrow-column.ui-state-default, .slick-footerrow-column.ui-state-default {\r\n  padding: 4px;\r\n}\r\n\r\n.slick-header-column-sorted {\r\n  font-style: italic;\r\n}\r\n\r\n.slick-sort-indicator {\r\n  display: inline-block;\r\n  width: 8px;\r\n  height: 5px;\r\n  margin-left: 4px;\r\n  margin-top: 6px;\r\n  float: left;\r\n}\r\n\r\n.slick-sort-indicator-numbered {\r\n  display: inline-block;\r\n  width: 8px;\r\n  height: 5px;\r\n  margin-left: 4px;\r\n  margin-top: 0;\r\n  line-height: 20px;\r\n  float: left;\r\n  font-family: Arial;\r\n  font-style: normal;\r\n  font-weight: bold;\r\n  color: #6190CD;\r\n}\r\n\r\n.slick-sort-indicator-desc {\r\n  background: url("+f+");\r\n}\r\n\r\n.slick-sort-indicator-asc {\r\n  background: url("+h+");\r\n}\r\n\r\n.slick-resizable-handle {\r\n  position: absolute;\r\n  font-size: 0.1px;\r\n  display: block;\r\n  cursor: col-resize;\r\n  width: 9px;\r\n  right: -5px;\r\n  top: 0;\r\n  height: 100%;\r\n  z-index: 1;\r\n}\r\n\r\n.slick-sortable-placeholder {\r\n  background: silver;\r\n}\r\n\r\n.grid-canvas {\r\n  position: relative;\r\n  outline: 0;\r\n}\r\n\r\n.slick-row.ui-widget-content, .slick-row.ui-state-active {\r\n  position: absolute;\r\n  border: 0px;\r\n  width: 100%;\r\n}\r\n\r\n.slick-cell, .slick-headerrow-column , .slick-footerrow-column{\r\n  position: absolute;\r\n  border: 1px solid transparent;\r\n  border-right: 1px dotted silver;\r\n  border-bottom-color: silver;\r\n  overflow: hidden;\r\n  -o-text-overflow: ellipsis;\r\n  text-overflow: ellipsis;\r\n  vertical-align: middle;\r\n  z-index: 1;\r\n  padding: 1px 2px 2px 1px;\r\n  margin: 0;\r\n  white-space: nowrap;\r\n  cursor: default;\r\n}\r\n.slick-cell, .slick-headerrow-column{\r\n  border-bottom-color: silver;\r\n}\r\n.slick-footerrow-column {\r\n  border-top-color: silver;\r\n}\r\n\r\n.slick-group {\r\n}\r\n\r\n.slick-group-toggle {\r\n  display: inline-block;\r\n}\r\n\r\n.slick-cell.highlighted {\r\n  background: lightskyblue;\r\n  background: rgba(0, 0, 255, 0.2);\r\n  -webkit-transition: all 0.5s;\r\n  -moz-transition: all 0.5s;\r\n  -o-transition: all 0.5s;\r\n  transition: all 0.5s;\r\n}\r\n\r\n.slick-cell.flashing {\r\n  border: 1px solid red !important;\r\n}\r\n\r\n.slick-cell.editable {\r\n  z-index: 11;\r\n  overflow: visible;\r\n  background: white;\r\n  border-color: black;\r\n  border-style: solid;\r\n}\r\n\r\n.slick-cell:focus {\r\n  outline: none;\r\n}\r\n\r\n.slick-reorder-proxy {\r\n  display: inline-block;\r\n  background: blue;\r\n  opacity: 0.15;\r\n  filter: alpha(opacity = 15);\r\n  cursor: move;\r\n}\r\n\r\n.slick-reorder-guide {\r\n  display: inline-block;\r\n  height: 2px;\r\n  background: blue;\r\n  opacity: 0.7;\r\n  filter: alpha(opacity = 70);\r\n}\r\n\r\n.slick-reorder-shadow-row {\r\n  position: absolute;\r\n  z-index: 999999;\r\n  box-shadow: rgb(0 0 0 / 20%) 8px 2px 8px 4px, rgb(0 0 0 / 19%) 2px 2px 0px 0px;\r\n}\r\n\r\n.slick-selection {\r\n  z-index: 10;\r\n  position: absolute;\r\n  border: 2px dashed black;\r\n}\r\n\r\n.slick-pane {\r\n  position: absolute;\r\n  outline: 0;\r\n  overflow: hidden;\r\n  width: 100%;\r\n}\r\n\r\n.slick-pane-header {\r\n  display: block;\r\n}\r\n\r\n.slick-header {\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.slick-headerrow {\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.slick-top-panel-scroller {\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.slick-top-panel {\r\n  width: 10000px\r\n}\r\n\r\n.slick-viewport {\r\n  position: relative;\r\n  outline: 0;\r\n  width: 100%;\r\n}\r\n","",{version:3,sources:["webpack://./node_modules/slickgrid/slick.grid.css"],names:[],mappings:"AAAA;;;;;CAKC;;AAED;EACE,WAAW;EACX,cAAc;EACd,kBAAkB;EAClB,2BAA2B;AAC7B;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE;AACF;;AAEA;EACE,kBAAkB;EAClB,mBAAmB;EACnB,eAAe;EACf,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,qBAAqB;EACrB,kCAAkC,EAAE,gCAAgC;EACpE,gBAAgB;EAChB,0BAA0B;EAC1B,uBAAuB;EACvB,YAAY;EACZ,iBAAiB;EACjB,SAAS;EACT,YAAY;EACZ,8BAA8B;EAC9B,2BAA2B;EAC3B,0BAA0B;EAC1B,6BAA6B;EAC7B,WAAW;AACb;;AAEA;EACE,0BAA0B;EAC1B,uBAAuB;EACvB,SAAS;EACT,YAAY;EACZ,8BAA8B;EAC9B,gBAAgB;EAChB,eAAe;EACf,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,sBAAsB;AACxB;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,qBAAqB;EACrB,UAAU;EACV,WAAW;EACX,gBAAgB;EAChB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,qBAAqB;EACrB,UAAU;EACV,WAAW;EACX,gBAAgB;EAChB,aAAa;EACb,iBAAiB;EACjB,WAAW;EACX,kBAAkB;EAClB,kBAAkB;EAClB,iBAAiB;EACjB,cAAc;AAChB;;AAEA;EACE,mDAAqC;AACvC;;AAEA;EACE,mDAAoC;AACtC;;AAEA;EACE,kBAAkB;EAClB,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,UAAU;EACV,WAAW;EACX,MAAM;EACN,YAAY;EACZ,UAAU;AACZ;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,UAAU;AACZ;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,kBAAkB;EAClB,6BAA6B;EAC7B,+BAA+B;EAC/B,2BAA2B;EAC3B,gBAAgB;EAChB,0BAA0B;EAC1B,uBAAuB;EACvB,sBAAsB;EACtB,UAAU;EACV,wBAAwB;EACxB,SAAS;EACT,mBAAmB;EACnB,eAAe;AACjB;AACA;EACE,2BAA2B;AAC7B;AACA;EACE,wBAAwB;AAC1B;;AAEA;AACA;;AAEA;EACE,qBAAqB;AACvB;;AAEA;EACE,wBAAwB;EACxB,gCAAgC;EAChC,4BAA4B;EAC5B,yBAAyB;EACzB,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,gCAAgC;AAClC;;AAEA;EACE,WAAW;EACX,iBAAiB;EACjB,iBAAiB;EACjB,mBAAmB;EACnB,mBAAmB;AACrB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,qBAAqB;EACrB,gBAAgB;EAChB,aAAa;EACb,2BAA2B;EAC3B,YAAY;AACd;;AAEA;EACE,qBAAqB;EACrB,WAAW;EACX,gBAAgB;EAChB,YAAY;EACZ,2BAA2B;AAC7B;;AAEA;EACE,kBAAkB;EAClB,eAAe;EACf,8EAA8E;AAChF;;AAEA;EACE,WAAW;EACX,kBAAkB;EAClB,wBAAwB;AAC1B;;AAEA;EACE,kBAAkB;EAClB,UAAU;EACV,gBAAgB;EAChB,WAAW;AACb;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE;AACF;;AAEA;EACE,kBAAkB;EAClB,UAAU;EACV,WAAW;AACb",sourcesContent:["/*\r\nIMPORTANT:\r\nIn order to preserve the uniform grid appearance, all cell styles need to have padding, margin and border sizes.\r\nNo built-in (selected, editable, highlight, flashing, invalid, loading, :focus) or user-specified CSS\r\nclasses should alter those!\r\n*/\r\n\r\n.slick-header.ui-state-default, .slick-headerrow.ui-state-default, .slick-footerrow.ui-state-default, .slick-top-panel-scroller.ui-state-default, .slick-group-header.ui-state-default {\r\n  width: 100%;\r\n  overflow: auto;\r\n  position: relative;\r\n  border-left: 0px !important;\r\n}\r\n\r\n.slick-header.ui-state-default {\r\n  overflow: inherit;\r\n}\r\n\r\n.slick-header::-webkit-scrollbar,  .slick-headerrow::-webkit-scrollbar, .slick-footerrow::-webkit-scrollbar {\r\n  display: none\r\n}\r\n\r\n.slick-header-columns, .slick-headerrow-columns, .slick-footerrow-columns, .slick-group-header-columns {\r\n  position: relative;\r\n  white-space: nowrap;\r\n  cursor: default;\r\n  overflow: hidden;\r\n}\r\n\r\n.slick-header-column.ui-state-default, .slick-group-header-column.ui-state-default {\r\n  position: relative;\r\n  display: inline-block;\r\n  box-sizing: content-box !important; /* this here only for Firefox! */ \r\n  overflow: hidden;\r\n  -o-text-overflow: ellipsis;\r\n  text-overflow: ellipsis;\r\n  height: 16px;\r\n  line-height: 16px;\r\n  margin: 0;\r\n  padding: 4px;\r\n  border-right: 1px solid silver;\r\n  border-left: 0px !important;\r\n  border-top: 0px !important;\r\n  border-bottom: 0px !important;\r\n  float: left;\r\n}\r\n\r\n.slick-footerrow-column.ui-state-default {\r\n  -o-text-overflow: ellipsis;\r\n  text-overflow: ellipsis;\r\n  margin: 0;\r\n  padding: 4px;\r\n  border-right: 1px solid silver;\r\n  border-left: 0px;\r\n  border-top: 0px;\r\n  border-bottom: 0px;\r\n  float: left;\r\n  line-height: 20px;\r\n  vertical-align: middle;\r\n}\r\n\r\n.slick-headerrow-column.ui-state-default, .slick-footerrow-column.ui-state-default {\r\n  padding: 4px;\r\n}\r\n\r\n.slick-header-column-sorted {\r\n  font-style: italic;\r\n}\r\n\r\n.slick-sort-indicator {\r\n  display: inline-block;\r\n  width: 8px;\r\n  height: 5px;\r\n  margin-left: 4px;\r\n  margin-top: 6px;\r\n  float: left;\r\n}\r\n\r\n.slick-sort-indicator-numbered {\r\n  display: inline-block;\r\n  width: 8px;\r\n  height: 5px;\r\n  margin-left: 4px;\r\n  margin-top: 0;\r\n  line-height: 20px;\r\n  float: left;\r\n  font-family: Arial;\r\n  font-style: normal;\r\n  font-weight: bold;\r\n  color: #6190CD;\r\n}\r\n\r\n.slick-sort-indicator-desc {\r\n  background: url(images/sort-desc.gif);\r\n}\r\n\r\n.slick-sort-indicator-asc {\r\n  background: url(images/sort-asc.gif);\r\n}\r\n\r\n.slick-resizable-handle {\r\n  position: absolute;\r\n  font-size: 0.1px;\r\n  display: block;\r\n  cursor: col-resize;\r\n  width: 9px;\r\n  right: -5px;\r\n  top: 0;\r\n  height: 100%;\r\n  z-index: 1;\r\n}\r\n\r\n.slick-sortable-placeholder {\r\n  background: silver;\r\n}\r\n\r\n.grid-canvas {\r\n  position: relative;\r\n  outline: 0;\r\n}\r\n\r\n.slick-row.ui-widget-content, .slick-row.ui-state-active {\r\n  position: absolute;\r\n  border: 0px;\r\n  width: 100%;\r\n}\r\n\r\n.slick-cell, .slick-headerrow-column , .slick-footerrow-column{\r\n  position: absolute;\r\n  border: 1px solid transparent;\r\n  border-right: 1px dotted silver;\r\n  border-bottom-color: silver;\r\n  overflow: hidden;\r\n  -o-text-overflow: ellipsis;\r\n  text-overflow: ellipsis;\r\n  vertical-align: middle;\r\n  z-index: 1;\r\n  padding: 1px 2px 2px 1px;\r\n  margin: 0;\r\n  white-space: nowrap;\r\n  cursor: default;\r\n}\r\n.slick-cell, .slick-headerrow-column{\r\n  border-bottom-color: silver;\r\n}\r\n.slick-footerrow-column {\r\n  border-top-color: silver;\r\n}\r\n\r\n.slick-group {\r\n}\r\n\r\n.slick-group-toggle {\r\n  display: inline-block;\r\n}\r\n\r\n.slick-cell.highlighted {\r\n  background: lightskyblue;\r\n  background: rgba(0, 0, 255, 0.2);\r\n  -webkit-transition: all 0.5s;\r\n  -moz-transition: all 0.5s;\r\n  -o-transition: all 0.5s;\r\n  transition: all 0.5s;\r\n}\r\n\r\n.slick-cell.flashing {\r\n  border: 1px solid red !important;\r\n}\r\n\r\n.slick-cell.editable {\r\n  z-index: 11;\r\n  overflow: visible;\r\n  background: white;\r\n  border-color: black;\r\n  border-style: solid;\r\n}\r\n\r\n.slick-cell:focus {\r\n  outline: none;\r\n}\r\n\r\n.slick-reorder-proxy {\r\n  display: inline-block;\r\n  background: blue;\r\n  opacity: 0.15;\r\n  filter: alpha(opacity = 15);\r\n  cursor: move;\r\n}\r\n\r\n.slick-reorder-guide {\r\n  display: inline-block;\r\n  height: 2px;\r\n  background: blue;\r\n  opacity: 0.7;\r\n  filter: alpha(opacity = 70);\r\n}\r\n\r\n.slick-reorder-shadow-row {\r\n  position: absolute;\r\n  z-index: 999999;\r\n  box-shadow: rgb(0 0 0 / 20%) 8px 2px 8px 4px, rgb(0 0 0 / 19%) 2px 2px 0px 0px;\r\n}\r\n\r\n.slick-selection {\r\n  z-index: 10;\r\n  position: absolute;\r\n  border: 2px dashed black;\r\n}\r\n\r\n.slick-pane {\r\n  position: absolute;\r\n  outline: 0;\r\n  overflow: hidden;\r\n  width: 100%;\r\n}\r\n\r\n.slick-pane-header {\r\n  display: block;\r\n}\r\n\r\n.slick-header {\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.slick-headerrow {\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.slick-top-panel-scroller {\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.slick-top-panel {\r\n  width: 10000px\r\n}\r\n\r\n.slick-viewport {\r\n  position: relative;\r\n  outline: 0;\r\n  width: 100%;\r\n}\r\n"],sourceRoot:""}]);const p=u},7865:(e,o,t)=>{var r=t(19755);var n=t(27672);var i=n;if(typeof i["$"]==="undefined")i["$"]=r;if(typeof i["jQuery"]==="undefined")i["jQuery"]=r;e.exports=r},27672:(e,o,t)=>{"use strict";e.exports=function(){if(typeof globalThis==="object"){return globalThis}var e;try{e=this||new Function("return this")()}catch(o){if(typeof window==="object"){return window}if(typeof self==="object"){return self}if(typeof t.g!=="undefined"){return t.g}}return e}()},56075:(e,o,t)=>{"use strict";t.d(o,{Z:()=>r});const r=t.p+"a320ae93e846a3918e40919ba7e78efb9da208a3d3708f355da3979bdd09d3b3.gif"},80746:(e,o,t)=>{"use strict";t.d(o,{Z:()=>r});const r=t.p+"dd4b6c9f688cf8d29e01bf94a5d10c6d5d285f73dc2c0e124ba205127533e165.gif"},99142:(e,o,t)=>{"use strict";t.r(o);t.d(o,{ISpreadsheetTracker:()=>_,default:()=>G});var r=t(97577);var n=t(3378);var i=t(91100);var l=t(34576);var a=t(89063);var s=t(27675);class d{constructor({value:e}){this._workbookChanged=new s.Subject;this._sheetChanged=new s.Subject;this._activeSheet=null;this._isDisposed=false;this._value=e;this._subscription=e.subscribe(this.handleContentChanged.bind(this))}get isDisposed(){return this._isDisposed}get workbookChanged(){return this._workbookChanged}get sheetChanged(){return this._sheetChanged}get activeSheet(){return this._activeSheet}dispose(){if(this._isDisposed){return}this._sheetChanged.complete();this._workbookChanged.complete();this._subscription.unsubscribe();delete this._workbook}setSheet(e){this._activeSheet=e;this._sheetChanged.next(e)}getSheetNames(){if(this._workbook==null){return[]}return this._workbook.SheetNames}getExtent(){if(this._activeSheet==null||this._workbook==null){return{s:{c:0,r:0},e:{c:0,r:0}}}const e=this._workbook.Sheets[this._activeSheet];const o=e["!ref"]||"A1:A1";const t=a.utils.decode_range(o);t.s={c:0,r:0};return t}getLength(){const e=this.getExtent();return e.e.r-e.s.r+1}getItem(e){const o={id:e};if(this._workbook==null||this._activeSheet==null){return Object.freeze(o)}const t=this._workbook.Sheets[this._activeSheet];const r=this.getExtent();const n=r.e.c-r.s.c;for(let i=0;i<=n;i++){const r=a.utils.encode_cell({r:e,c:i});let n=null;if(r in t){n=t[r]}o["c"+i]=n}return Object.freeze(o)}getItemMetadata(e){const o={columns:{}};if(this._workbook==null||this._activeSheet==null){return Object.freeze(o)}const t=this._workbook.Sheets[this._activeSheet];if(t["!merges"]==null){return Object.freeze(o)}const r=t["!merges"];for(let n=0;n<r.length;n++){const t=r[n];if(e<t.s.r||t.e.r<e){continue}const i=t.e.r-t.s.r>0&&e<t.e.r;o.columns["c"+t.s.c]={colspan:t.e.c-t.s.c+1,mergeDown:i}}return Object.freeze(o)}getColumnConfig(){if(this._workbook==null||this._activeSheet==null){return[]}const e=this._workbook.Sheets[this._activeSheet];const o=this.getExtent();const t=[{id:"row",name:"#",field:"id",cssClass:"sp-Row-Index",headerCssClass:"sp-GridHeader",formatter:(e,o,t)=>""+(1+t)}];for(let r=o.s.c;r<=o.e.c;r++){const o=a.utils.encode_col(r);const n=e["!cols"]?e["!cols"][r].width:void 0;t.push({id:"c"+r,name:o,field:"c"+r,width:n,headerCssClass:"sp-GridHeader"})}return t}toCsv(e){const o=e||this._activeSheet;if(this._workbook==null||o==null){return null}const t=this._workbook.Sheets[o];return a.utils.sheet_to_csv(t,{FS:","})}handleContentChanged(e){this._workbook=(0,a.read)(e);this._activeSheet=this._workbook.SheetNames[0];this._workbookChanged.next(void 0)}}class c extends l.DocumentModel{constructor(e){super(void 0,e);this._observable=new s.Subject;this._model=new d({value:this._observable});this._observable.next(this.value.text);this.value.changed.connect(this.valueChanged,this)}get model(){return this._model}dispose(){if(this.isDisposed)return;this._observable.complete();this.value.changed.disconnect(this.valueChanged,this);this._model.dispose()}valueChanged(){this._observable.next(this.value.text)}}class u extends l.Base64ModelFactory{createNew(e,o){return new c(o)}get name(){return"workbook"}}var f=t(700);var h=t(7865);var p=t(56337);var v=t(81812);var g=t(52947);var m=t(26491);var w=t(33059);var C=t(93379);var A=t.n(C);var R=t(77050);var $={};$.insert="head";$.singleton=false;var S=A()(R.Z,$);const b=R.Z.locals||{};function k(e,o,t,r,n,i){const l=t;const a={text:"",addClasses:"sp-Cell ",removeClasses:"sp-Cell-Number sp-Cell-Error sp-Cell-MergeDown"};const s=i.getData().getItemMetadata(e);const d=r.id;if(d&&s.columns&&d in s.columns){if(s.columns[d].mergeDown){a.addClasses+="sp-Cell-MergeDown "}}if(l==null){return a}a.text=l.h||l.w||""+l.v;const c=l.t;switch(c){case"n":a.addClasses+="sp-Cell-Number";break;case"e":a.addClasses+="sp-Cell-Error";break;default:break}return Object.freeze(a)}var y=t(84102);var x={};x.insert="head";x.singleton=false;var E=A()(y.Z,x);const B=y.Z.locals||{};class z extends f.Widget{constructor({model:e}){super();this.addClass("sp-Grid");this._model=e;this._subscription=(0,s.merge)(e.sheetChanged,e.workbookChanged).subscribe((()=>this.update()));this._columnConfig=e.getColumnConfig();this._grid=this.buildGrid()}dispose(){if(this.isDisposed){return}this._subscription.unsubscribe();this._grid.destroy()}onUpdateRequest(){this._columnConfig=this._model.getColumnConfig();this._grid.destroy();this._grid=this.buildGrid()}onAfterShow(){if(this._grid==null)return;this._grid.render()}onResize(){if(this._grid==null)return;this._grid.resizeCanvas()}buildGrid(){const e=new Slick.Grid(this.node,this._model,this._columnConfig,{defaultFormatter:k,enableColumnReorder:false});return e}}var P=t(89523);var L={};L.insert="head";L.singleton=false;var H=A()(P.Z,L);const T=P.Z.locals||{};class F extends f.Widget{constructor({model:e}){super();this.addClass(F.CSS_CLASS);this.model=e;this.layout=new f.BoxLayout({});this.grid=new z({model:e});this.tabBar=new f.TabBar({allowDeselect:false,tabsMovable:false});this.layout.addWidget(this.grid);this.layout.addWidget(this.tabBar);f.BoxLayout.setSizeBasis(this.tabBar,26);f.BoxLayout.setStretch(this.grid,1);this.tabBar.currentChanged.connect(this.handleSheetChanged,this);this._subscription=this.model.workbookChanged.subscribe((()=>this.handleModelContentChanged()))}dispose(){if(this.isDisposed){return}this.grid.dispose();this.tabBar.dispose();this._subscription.unsubscribe();super.dispose()}handleSheetChanged(e,{currentTitle:o}){if(o==null){return}this.model.setSheet(o.label)}handleModelContentChanged(){this.tabBar.clearTabs();const e=this.model.getSheetNames();for(const o of e){this.tabBar.addTab({label:o,owner:void 0})}this.tabBar.currentIndex=e.indexOf(this.model.activeSheet||"")}}(function(e){e.CSS_CLASS="sp-SpreadsheetWidget"})(F||(F={}));class W extends l.ABCWidgetFactory{createNewWidget(e){const o=e.model.model;const t=new F({model:o});const r=new l.DocumentWidget({content:t,context:e});return r}}const I="application/vnd.ms-excel";const D="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";const M="application/vnd.oasis.opendocument.spreadsheet";const N="application/vnd.sheetjs.csf+json";const _=new i.Token("jupyterlab-spreadsheet:tracker");function V(e,o){const{docRegistry:t}=e;const r=new n.WidgetTracker({namespace:"jupyterlab-spreadsheet"});const i=new W({name:"Spreadsheet",modelName:"workbook",fileTypes:["excel","csv","dsv","ods"],defaultFor:["excel","ods"]});const l=new u;t.addModelFactory(l);t.addWidgetFactory(i);t.addFileType({name:"excel",displayName:"Excel Workbook",fileFormat:"base64",extensions:[".xls",".xlsx"],mimeTypes:[I,D,"application/octet-stream","text/plain"]});t.addFileType({name:"ods",displayName:"OpenOffice/LibreOffice Workbook",fileFormat:"base64",extensions:[".ods"],mimeTypes:[M,"application/octet-stream","text/plain"]});i.widgetCreated.connect(((e,o)=>{void r.add(o);o.context.pathChanged.connect((()=>{void r.save(o)}))}));void o.restore(r,{command:"docmanager:open",args:e=>({path:e.context.path,factory:"Spreadsheet"}),name:e=>e.context.path});return r}const O={id:"jupyter-spreadsheet",autoStart:true,requires:[r.ILayoutRestorer],provides:_,activate:V};const G=O},81812:()=>{(function(e){e.fn.drag=function(o,t,r){var n=typeof o=="string"?o:"",i=e.isFunction(o)?o:e.isFunction(t)?t:null;if(n.indexOf("drag")!==0)n="drag"+n;r=(o==i?t:r)||{};return i?this.on(n,r,i):this.trigger(n)};var o=e.event,t=o.special,r=t.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:false,drop:true,click:false},datakey:"dragdata",noBubble:true,add:function(o){var t=e.data(this,r.datakey),n=o.data||{};t.related+=1;e.each(r.defaults,(function(e,o){if(n[e]!==undefined)t[e]=n[e]}))},remove:function(){var o=e.data(this,r.datakey);if(o)o.related-=1},setup:function(){if(e.data(this,r.datakey))return;var t=e.extend({related:0},r.defaults);e.data(this,r.datakey,t);o.add(this,"touchstart mousedown",r.init,t);if(this.attachEvent)this.attachEvent("ondragstart",r.dontstart)},teardown:function(){var t=e.data(this,r.datakey)||{};if(t.related)return;e.removeData(this,r.datakey);o.remove(this,"touchstart mousedown",r.init);r.textselect(true);if(this.detachEvent)this.detachEvent("ondragstart",r.dontstart)},init:function(n){if(r.touched)return;var i=n.data,l;if(n.which!=0&&i.which>0&&n.which!=i.which)return;var a=e(n.target).attr("class")||"";if(e(n.target).is(i.not)||(!a||a.toString().indexOf("slick")===-1))return;if(i.handle&&!e(n.target).closest(i.handle,n.currentTarget).length)return;r.touched=n.type=="touchstart"?this:null;i.propagates=1;i.mousedown=this;i.interactions=[r.interaction(this,i)];i.target=n.target;i.pageX=n.pageX;i.pageY=n.pageY;i.dragging=null;l=r.hijack(n,"draginit",i);if(!i.propagates)return;l=r.flatten(l);if(l&&l.length){i.interactions=[];e.each(l,(function(){i.interactions.push(r.interaction(this,i))}))}i.propagates=i.interactions.length;if(i.drop!==false&&t.drop)t.drop.handler(n,i);r.textselect(false);if(r.touched)o.add(r.touched,"touchmove touchend",r.handler,i);else o.add(document,"mousemove mouseup",r.handler,i);if(!r.touched||i.live)return false},interaction:function(o,t){var n=o&&o.ownerDocument?e(o)[t.relative?"position":"offset"]()||{top:0,left:0}:{top:0,left:0};return{drag:o,callback:new r.callback,droppable:[],offset:n}},handler:function(n){var i=n.data;switch(n.type){case!i.dragging&&"touchmove":n.preventDefault();case!i.dragging&&"mousemove":if(Math.pow(n.pageX-i.pageX,2)+Math.pow(n.pageY-i.pageY,2)<Math.pow(i.distance,2))break;n.target=i.target;r.hijack(n,"dragstart",i);if(i.propagates)i.dragging=true;case"touchmove":n.preventDefault();case"mousemove":if(i.dragging){r.hijack(n,"drag",i);if(i.propagates){if(i.drop!==false&&t.drop)t.drop.handler(n,i);break}n.type="mouseup"}case"touchend":case"mouseup":default:if(r.touched)o.remove(r.touched,"touchmove touchend",r.handler);else o.remove(document,"mousemove mouseup",r.handler);if(i.dragging){if(i.drop!==false&&t.drop)t.drop.handler(n,i);r.hijack(n,"dragend",i)}r.textselect(true);if(i.click===false&&i.dragging)e.data(i.mousedown,"suppress.click",(new Date).getTime()+5);i.dragging=r.touched=false;break}},hijack:function(t,n,i,l,a){if(!i)return;var s={event:t.originalEvent,type:t.type},d=n.indexOf("drop")?"drag":"drop",c,u=l||0,f,h,p,v=!isNaN(l)?l:i.interactions.length;t.type=n;var g=function(){};t.originalEvent=new jQuery.Event(s.event,{preventDefault:g,stopPropagation:g,stopImmediatePropagation:g});i.results=[];do{if(f=i.interactions[u]){if(n!=="dragend"&&f.cancelled)continue;p=r.properties(t,i,f);f.results=[];e(a||f[d]||i.droppable).each((function(l,a){p.target=a;t.isPropagationStopped=function(){return false};c=a?o.dispatch.call(a,t,p):null;if(c===false){if(d=="drag"){f.cancelled=true;i.propagates-=1}if(n=="drop"){f[d][l]=null}}else if(n=="dropinit")f.droppable.push(r.element(c)||a);if(n=="dragstart")f.proxy=e(r.element(c)||f.drag)[0];f.results.push(c);delete t.result;if(n!=="dropinit")return c}));i.results[u]=r.flatten(f.results);if(n=="dropinit")f.droppable=r.flatten(f.droppable);if(n=="dragstart"&&!f.cancelled)p.update()}}while(++u<v);t.type=s.type;t.originalEvent=s.event;return r.flatten(i.results)},properties:function(e,o,t){var n=t.callback;n.drag=t.drag;n.proxy=t.proxy||t.drag;n.startX=o.pageX;n.startY=o.pageY;n.deltaX=e.pageX-o.pageX;n.deltaY=e.pageY-o.pageY;n.originalX=t.offset.left;n.originalY=t.offset.top;n.offsetX=n.originalX+n.deltaX;n.offsetY=n.originalY+n.deltaY;n.drop=r.flatten((t.drop||[]).slice());n.available=r.flatten((t.droppable||[]).slice());return n},element:function(e){if(e&&(e.jquery||e.nodeType==1))return e},flatten:function(o){return e.map(o,(function(o){return o&&o.jquery?e.makeArray(o):o&&o.length?r.flatten(o):o}))},textselect:function(o){e(document)[o?"off":"on"]("selectstart",r.dontstart).css("MozUserSelect",o?"":"none");document.unselectable=o?"off":"on"},dontstart:function(){return false},callback:function(){}};r.callback.prototype={update:function(){if(t.drop&&this.available.length)e.each(this.available,(function(e){t.drop.locate(this,e)}))}};var n=o.dispatch;o.dispatch=function(o){if(e.data(this,"suppress."+o.type)-(new Date).getTime()>0){e.removeData(this,"suppress."+o.type);return}return n.apply(this,arguments)};t.draginit=t.dragstart=t.dragend=r})(jQuery)},52947:()=>{(function(e){function o(){var e=false;var o=false;this.stopPropagation=function(){e=true};this.isPropagationStopped=function(){return e};this.stopImmediatePropagation=function(){o=true};this.isImmediatePropagationStopped=function(){return o}}function t(){var e=[];this.subscribe=function(o){e.push(o)};this.unsubscribe=function(o){for(var t=e.length-1;t>=0;t--){if(e[t]===o){e.splice(t,1)}}};this.notify=function(t,r,n){r=r||new o;n=n||this;var i;for(var l=0;l<e.length&&!(r.isPropagationStopped()||r.isImmediatePropagationStopped());l++){i=e[l].call(n,r,t)}return i}}function r(){var e=[];this.subscribe=function(o,t){e.push({event:o,handler:t});o.subscribe(t);return this};this.unsubscribe=function(o,t){var r=e.length;while(r--){if(e[r].event===o&&e[r].handler===t){e.splice(r,1);o.unsubscribe(t);return}}return this};this.unsubscribeAll=function(){var o=e.length;while(o--){e[o].event.unsubscribe(e[o].handler)}e=[];return this}}function n(e,o,t,r){if(t===undefined&&r===undefined){t=e;r=o}this.fromRow=Math.min(e,t);this.fromCell=Math.min(o,r);this.toRow=Math.max(e,t);this.toCell=Math.max(o,r);this.isSingleRow=function(){return this.fromRow==this.toRow};this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell};this.contains=function(e,o){return e>=this.fromRow&&e<=this.toRow&&o>=this.fromCell&&o<=this.toCell};this.toString=function(){if(this.isSingleCell()){return"("+this.fromRow+":"+this.fromCell+")"}else{return"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}}}function i(){this.__nonDataRow=true}function l(){this.__group=true;this.level=0;this.count=0;this.value=null;this.title=null;this.collapsed=false;this.selectChecked=false;this.totals=null;this.rows=[];this.groups=null;this.groupingKey=null}l.prototype=new i;l.prototype.equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title};function a(){this.__groupTotals=true;this.group=null;this.initialized=false}a.prototype=new i;function s(){var e=null;this.isActive=function(o){return o?e===o:e!==null};this.activate=function(o){if(o===e){return}if(e!==null){throw new Error("SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController")}if(!o.commitCurrentEdit){throw new Error("SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()")}if(!o.cancelCurrentEdit){throw new Error("SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()")}e=o};this.deactivate=function(o){if(!e){return}if(e!==o){throw new Error("SlickGrid.EditorLock.deactivate: specified editController is not the currently active one")}e=null};this.commitCurrentEdit=function(){return e?e.commitCurrentEdit():true};this.cancelCurrentEdit=function o(){return e?e.cancelCurrentEdit():true}}function d(o){var t={};function r(){n(o)}function n(e){e.forEach((function(e){t[e.id]=e;if(e.columns)n(e.columns)}))}function i(e,o){return e.filter((function(e){var t=o.call(e);if(t&&e.columns)e.columns=i(e.columns,o);return t&&(!e.columns||e.columns.length)}))}function l(e,o){e.sort((function(e,t){var r=a(o.getColumnIndex(e.id)),n=a(o.getColumnIndex(t.id));return r-n})).forEach((function(e){if(e.columns)l(e.columns,o)}))}function a(e){return typeof e==="undefined"?-1:e}function s(e){if(e.length)for(var o in e)return s(e[o]);else if(e.columns)return 1+s(e.columns);else return 1}function d(e,o,t){var r=[];t=t||0;if(o==t){if(e.length)e.forEach((function(e){if(e.columns)e.extractColumns=function(){return c(e)}}));return e}else for(var n in e)if(e[n].columns){r=r.concat(d(e[n].columns,o,t+1))}return r}function c(e){var o=[];if(e.hasOwnProperty("length")){for(var t=0;t<e.length;t++)o=o.concat(c(e[t]))}else{if(e.hasOwnProperty("columns"))o=o.concat(c(e.columns));else return e}return o}function u(){return e.extend(true,[],o)}r();this.hasDepth=function(){for(var e in o)if(o[e].hasOwnProperty("columns"))return true;return false};this.getTreeColumns=function(){return o};this.extractColumns=function(){return this.hasDepth()?c(o):o};this.getDepth=function(){return s(o)};this.getColumnsInDepth=function(e){return d(o,e)};this.getColumnsInGroup=function(e){return c(e)};this.visibleColumns=function(){return i(u(),(function(){return this.visible}))};this.filter=function(e){return i(u(),e)};this.reOrder=function(e){return l(o,e)};this.getById=function(e){return t[e]};this.getInIds=function(e){return e.map((function(e){return t[e]}))}}var c="Map"in window?window.Map:function e(){var o={};this.get=function(e){return o[e]};this.set=function(e,t){o[e]=t};this.has=function(e){return e in o};this.delete=function(e){delete o[e]}};e.extend(true,window,{Slick:{Event:t,EventData:o,EventHandler:r,Range:n,Map:c,NonDataRow:i,Group:l,GroupTotals:a,EditorLock:s,GlobalEditorLock:new s,TreeColumns:d,keyCode:{SPACE:8,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{CanvasTextSize:"CANV",HTML:"HTML"}}})})(jQuery)},26491:()=>{(function(e){function o(o){var t=this;var r={groupItemMetadataProvider:null,inlineFilters:false};var n="id";var i=[];var l=[];var a=new Slick.Map;var s=null;var d=null;var c=null;var u=false;var f=false;var h=new Slick.Map;var p=true;var v;var g;var m={};var w={};var C;var A=[];var R;var $;var S=[];var b=null;var k={getter:null,formatter:null,comparer:function(e,o){return e.value===o.value?0:e.value>o.value?1:-1},predefinedValues:[],aggregators:[],aggregateEmpty:false,aggregateCollapsed:false,aggregateChildGroups:false,collapsed:false,displayTotalsRow:true,lazyTotalsCalculation:false};var y=[];var x=[];var E=[];var B=":|:";var z=null;var P=0;var L=0;var H=0;var T=new Slick.Event;var F=new Slick.Event;var W=new Slick.Event;var I=new Slick.Event;var D=new Slick.Event;var M=new Slick.Event;var N=new Slick.Event;var _=new Slick.Event;o=e.extend(true,{},r,o);function V(e){u=true;f=e===true}function O(){var e=f;f=false;u=false;if(e){U();Y()}io()}function G(){i=[];a=null;s=null;d=null;c=null;g=null;S=[];A=[];R=null;$=null;if(b&&b.onSelectedRowsChanged&&b.onCellCssStylesChanged){b.onSelectedRowsChanged.unsubscribe();b.onCellCssStylesChanged.unsubscribe()}if(t.onRowsOrCountChanged){t.onRowsOrCountChanged.unsubscribe()}}function j(e){m=e}function X(e){C=e}function U(){var e,o,t=0;for(var r=0,l=i.length;r<l;r++){o=i[r];e=o[n];if(e===undefined){throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}if(h.has(e)){a.delete(e)}else{i[t]=o;a.set(e,t);++t}}i.length=t;h=new Slick.Map}function q(e){if(f){return}e=e||0;var o;for(var t=e,r=i.length;t<r;t++){o=i[t][n];if(o===undefined){throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}a.set(o,t)}}function Y(){if(f){return}var e;for(var o=0,t=i.length;o<t;o++){e=i[o][n];if(e===undefined||a.get(e)!==o){throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}}}function K(){return i}function Q(){return n}function Z(e,o){if(o!==undefined){n=o}i=A=e;T.notify({idProperty:o,itemCount:i.length},null,t);a=new Slick.Map;q();Y();io()}function J(e){if(D.notify(ee(),null,t)!==false){if(e.pageSize!=undefined){P=e.pageSize;L=P?Math.min(L,Math.max(0,Math.ceil(H/P)-1)):0}if(e.pageNum!=undefined){L=Math.min(e.pageNum,Math.max(0,Math.ceil(H/P)-1))}M.notify(ee(),null,t);io()}}function ee(){var e=P?Math.max(1,Math.ceil(H/P)):1;return{pageSize:P,pageNum:L,totalRows:H,totalPages:e,dataView:t}}function oe(e,o){p=o;g=e;v=null;if(o===false){i.reverse()}i.sort(e);if(o===false){i.reverse()}a=new Slick.Map;q();io()}function te(e,o){p=o;v=e;g=null;var t=Object.prototype.toString;Object.prototype.toString=typeof e=="function"?e:function(){return this[e]};if(o===false){i.reverse()}i.sort();Object.prototype.toString=t;if(o===false){i.reverse()}a=new Slick.Map;q();io()}function re(){if(g){oe(g,p)}else if(v){te(v,p)}}function ne(){return A}function ie(){return A.length}function le(){return d}function ae(e){d=e;if(o.inlineFilters){R=Qe();$=Ze()}io()}function se(){return y}function de(t){if(!o.groupItemMetadataProvider){o.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider}x=[];E=[];t=t||[];y=t instanceof Array?t:[t];for(var r=0;r<y.length;r++){var n=y[r]=e.extend(true,{},k,y[r]);n.getterIsAFn=typeof n.getter==="function";n.compiledAccumulators=[];var i=n.aggregators.length;while(i--){n.compiledAccumulators[i]=Ke(n.aggregators[i])}E[r]={}}io()}function ce(e,o,t){if(e==null){de([]);return}de({getter:e,formatter:o,comparer:t})}function ue(e,o){if(!y.length){throw new Error("[SlickGrid DataView] At least one grouping must be specified before calling setAggregators().")}y[0].aggregators=e;y[0].aggregateCollapsed=o;de(y)}function fe(e){return i[e]}function he(e){return a.get(e)}function pe(){if(!s){s={};for(var e=0,o=l.length;e<o;e++){s[l[e][n]]=e}}}function ve(e){pe();return s[e[n]]}function ge(e){pe();return s[e]}function me(e){return i[a.get(e)]}function we(e){var o=[];pe();for(var t=0,r=e.length;t<r;t++){var i=s[e[t][n]];if(i!=null){o[o.length]=i}}return o}function Ce(e){var o=[];pe();for(var t=0,r=e.length;t<r;t++){var n=s[e[t]];if(n!=null){o[o.length]=n}}return o}function Ae(e){var o=[];for(var t=0,r=e.length;t<r;t++){if(e[t]<l.length){o[o.length]=l[e[t]][n]}}return o}function Re(e,o){if(!a.has(e)){throw new Error("[SlickGrid DataView] Invalid id")}if(e!==o[n]){var t=o[n];if(t==null){throw new Error("[SlickGrid DataView] Cannot update item to associate with a null id")}if(a.has(t)){throw new Error("[SlickGrid DataView] Cannot update item to associate with a non-unique id")}a.set(t,a.get(e));a.delete(e);if(c&&c[e]){delete c[e]}e=t}i[a.get(e)]=o;if(!c){c={}}c[e]=true}function $e(e,o){Re(e,o);io()}function Se(e,o){if(e.length!==o.length){throw new Error("[SlickGrid DataView] Mismatch on the length of ids and items provided to update")}for(var t=0,r=o.length;t<r;t++){Re(e[t],o[t])}io()}function be(e,o){i.splice(e,0,o);q(e);io()}function ke(e,o){Array.prototype.splice.apply(i,[e,0].concat(o));q(e);io()}function ye(e){i.push(e);q(i.length-1);io()}function xe(e){i=i.concat(e);q(i.length-e.length);io()}function Ee(e){if(f){h.set(e,true)}else{var o=a.get(e);if(o===undefined){throw new Error("[SlickGrid DataView] Invalid id")}a.delete(e);i.splice(o,1);q(o);io()}}function Be(e){if(e.length===0){return}if(f){for(var o=0,t=e.length;o<t;o++){var r=e[o];var n=a.get(r);if(n===undefined){throw new Error("[SlickGrid DataView] Invalid id")}h.set(r,true)}}else{var l=[];for(var o=0,t=e.length;o<t;o++){var r=e[o];var n=a.get(r);if(n===undefined){throw new Error("[SlickGrid DataView] Invalid id")}a.delete(r);l.push(n)}l.sort();for(var o=l.length-1;o>=0;--o){i.splice(l[o],1)}q(l[0]);io()}}function ze(e){if(!g){throw new Error("[SlickGrid DataView] sortedAddItem() requires a sort comparer, use sort()")}be(Le(e),e)}function Pe(e,o){if(!a.has(e)||e!==o[n]){throw new Error("[SlickGrid DataView] Invalid or non-matching id "+a.get(e))}if(!g){throw new Error("[SlickGrid DataView] sortedUpdateItem() requires a sort comparer, use sort()")}var t=me(e);if(g(t,o)!==0){Ee(e);ze(o)}else{$e(e,o)}}function Le(e){var o=0,t=i.length;while(o<t){var r=o+t>>>1;if(g(i[r],e)===-1){o=r+1}else{t=r}}return o}function He(){return i.length}function Te(){return l.length}function Fe(e){var o=l[e];if(o&&o.__group&&o.totals&&!o.totals.initialized){var t=y[o.level];if(!t.displayTotalsRow){je(o.totals);o.title=t.formatter?t.formatter(o):o.value}}else if(o&&o.__groupTotals&&!o.initialized){je(o)}return o}function We(e){var t=l[e];if(t===undefined){return null}if(t.__group){return o.groupItemMetadataProvider.getGroupRowMetadata(t)}if(t.__groupTotals){return o.groupItemMetadataProvider.getTotalsRowMetadata(t)}return null}function Ie(e,o){if(e==null){for(var t=0;t<y.length;t++){E[t]={};y[t].collapsed=o;if(o===true){_.notify({level:t,groupingKey:null})}else{N.notify({level:t,groupingKey:null})}}}else{E[e]={};y[e].collapsed=o;if(o===true){_.notify({level:e,groupingKey:null})}else{N.notify({level:e,groupingKey:null})}}io()}function De(e){Ie(e,true)}function Me(e){Ie(e,false)}function Ne(e,o,t){E[e][o]=y[e].collapsed^t;io()}function _e(e){var o=Array.prototype.slice.call(arguments);var t=o[0];var r;var n;if(o.length===1&&t.indexOf(B)!==-1){r=t;n=t.split(B).length-1}else{r=o.join(B);n=o.length-1}Ne(n,r,true);_.notify({level:n,groupingKey:r})}function Ve(e){var o=Array.prototype.slice.call(arguments);var t=o[0];var r;var n;if(o.length===1&&t.indexOf(B)!==-1){n=t.split(B).length-1;r=t}else{n=o.length-1;r=o.join(B)}Ne(n,r,false);N.notify({level:n,groupingKey:r})}function Oe(){return x}function Ge(e,o){var t;var r;var n=[];var i={};var l;var a=o?o.level+1:0;var s=y[a];for(var d=0,c=s.predefinedValues.length;d<c;d++){r=s.predefinedValues[d];t=i[r];if(!t){t=new Slick.Group;t.value=r;t.level=a;t.groupingKey=(o?o.groupingKey+B:"")+r;n[n.length]=t;i[r]=t}}for(var d=0,c=e.length;d<c;d++){l=e[d];r=s.getterIsAFn?s.getter(l):l[s.getter];t=i[r];if(!t){t=new Slick.Group;t.value=r;t.level=a;t.groupingKey=(o?o.groupingKey+B:"")+r;n[n.length]=t;i[r]=t}t.rows[t.count++]=l}if(a<y.length-1){for(var d=0;d<n.length;d++){t=n[d];t.groups=Ge(t.rows,t)}}if(n.length){Ue(n,a)}n.sort(y[a].comparer);return n}function je(e){var o=e.group;var t=y[o.level];var r=o.level==y.length;var n,i=t.aggregators.length;if(!r&&t.aggregateChildGroups){var l=o.groups.length;while(l--){if(!o.groups[l].totals.initialized){je(o.groups[l].totals)}}}while(i--){n=t.aggregators[i];n.init();if(!r&&t.aggregateChildGroups){t.compiledAccumulators[i].call(n,o.groups)}else{t.compiledAccumulators[i].call(n,o.rows)}n.storeResult(e)}e.initialized=true}function Xe(e){var o=y[e.level];var t=new Slick.GroupTotals;t.group=e;e.totals=t;if(!o.lazyTotalsCalculation){je(t)}}function Ue(e,o){o=o||0;var t=y[o];var r=t.collapsed;var n=E[o];var i=e.length,l;while(i--){l=e[i];if(l.collapsed&&!t.aggregateCollapsed){continue}if(l.groups){Ue(l.groups,o+1)}if(t.aggregators.length&&(t.aggregateEmpty||l.rows.length||l.groups&&l.groups.length)){Xe(l)}l.collapsed=r^n[l.groupingKey];l.title=t.formatter?t.formatter(l):l.value}}function qe(e,o){o=o||0;var t=y[o];var r=[],n,i=0,l;for(var a=0,s=e.length;a<s;a++){l=e[a];r[i++]=l;if(!l.collapsed){n=l.groups?qe(l.groups,o+1):l.rows;for(var d=0,c=n.length;d<c;d++){r[i++]=n[d]}}if(l.totals&&t.displayTotalsRow&&(!l.collapsed||t.aggregateCollapsed)){r[i++]=l.totals}}return r}function Ye(e){var o=e.toString();var t=o.indexOf("function")>=0;var r=t?/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/:/^[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/;var n=e.toString().match(r);return{params:n[1].split(","),body:n[2]}}function Ke(e){if(e.accumulate){var o=Ye(e.accumulate);var t=new Function("_items","for (var "+o.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+o.params[0]+" = _items[_i]; "+o.body+"}");var r="compiledAccumulatorLoop";t.displayName=r;t.name=Je(t,r);return t}else{return function e(){}}}function Qe(){var e=Ye(d);var o="{ continue _coreloop; }$1";var t="{ _retval[_idx++] = $item$; continue _coreloop; }$1";var r=e.body.replace(/return false\s*([;}]|\}|$)/gi,o).replace(/return!1([;}]|\}|$)/gi,o).replace(/return true\s*([;}]|\}|$)/gi,t).replace(/return!0([;}]|\}|$)/gi,t).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");var n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,r);n=n.replace(/\$item\$/gi,e.params[0]);n=n.replace(/\$args\$/gi,e.params[1]);var i=new Function("_items,_args",n);var l="compiledFilter";i.displayName=l;i.name=Je(i,l);return i}function Ze(){var e=Ye(d);var o="{ continue _coreloop; }$1";var t="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1";var r=e.body.replace(/return false\s*([;}]|\}|$)/gi,o).replace(/return!1([;}]|\}|$)/gi,o).replace(/return true\s*([;}]|\}|$)/gi,t).replace(/return!0([;}]|\}|$)/gi,t).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");var n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,r);n=n.replace(/\$item\$/gi,e.params[0]);n=n.replace(/\$args\$/gi,e.params[1]);var i=new Function("_items,_args,_cache",n);var l="compiledFilterWithCaching";i.displayName=l;i.name=Je(i,l);return i}function Je(e,o){try{Object.defineProperty(e,"name",{writable:true,value:o})}catch(t){e.name=o}}function eo(e,o){var t=[],r=0;for(var n=0,i=e.length;n<i;n++){if(d(e[n],o)){t[r++]=e[n]}}return t}function oo(e,o,t){var r=[],n=0,i;for(var l=0,a=e.length;l<a;l++){i=e[l];if(t[l]){r[n++]=i}else if(d(i,o)){r[n++]=i;t[l]=true}}return r}function to(e){if(d){var t=o.inlineFilters?R:eo;var r=o.inlineFilters?$:oo;if(m.isFilterNarrowing){A=t(A,C)}else if(m.isFilterExpanding){A=r(e,C,S)}else if(!m.isFilterUnchanged){A=t(e,C)}}else{A=P?e:e.concat()}var n;if(P){if(A.length<=L*P){if(A.length===0){L=0}else{L=Math.floor((A.length-1)/P)}}n=A.slice(P*L,P*L+P)}else{n=A}return{totalRows:A.length,rows:n}}function ro(e,o){var t,r,i,l=[];var a=0,s=Math.max(o.length,e.length);if(m&&m.ignoreDiffsBefore){a=Math.max(0,Math.min(o.length,m.ignoreDiffsBefore))}if(m&&m.ignoreDiffsAfter){s=Math.min(o.length,Math.max(0,m.ignoreDiffsAfter))}for(var d=a,u=e.length;d<s;d++){if(d>=u){l[l.length]=d}else{t=o[d];r=e[d];if(!t||(y.length&&(i=t.__nonDataRow||r.__nonDataRow)&&t.__group!==r.__group||t.__group&&!t.equals(r))||i&&(t.__groupTotals||r.__groupTotals)||t[n]!=r[n]||c&&c[t[n]]){l[l.length]=d}}}return l}function no(e){s=null;if(m.isFilterNarrowing!=w.isFilterNarrowing||m.isFilterExpanding!=w.isFilterExpanding){S=[]}var o=to(e);H=o.totalRows;var t=o.rows;x=[];if(y.length){x=Ge(t);if(x.length){t=qe(x)}}var r=ro(l,t);l=t;return r}function io(){if(u){return}var o=e.extend(true,{},ee());var r=l.length;var n=H;var a=no(i,d);if(P&&H<L*P){L=Math.max(0,Math.ceil(H/P)-1);a=no(i,d)}c=null;w=m;m={};if(n!==H){if(D.notify(o,null,t)!==false){M.notify(ee(),null,t)}}if(r!==l.length){F.notify({previous:r,current:l.length,itemCount:i.length,dataView:t,callingOnRowsChanged:a.length>0},null,t)}if(a.length>0){W.notify({rows:a,itemCount:i.length,dataView:t,calledOnRowCountChanged:r!==l.length},null,t)}if(r!==l.length||a.length>0){I.notify({rowsDiff:a,previousRowCount:r,currentRowCount:l.length,itemCount:i.length,rowCountChanged:r!==l.length,rowsChanged:a.length>0,dataView:t},null,t)}}function lo(o,t,r){var n=this;b=o;var i;z=n.mapRowsToIds(o.getSelectedRows());var l=new Slick.Event;function a(e){if(z.join(",")==e.join(",")){return}z=e;l.notify({grid:o,ids:z,dataView:n},new Slick.EventData,n)}function s(){if(z.length>0){i=true;var e=n.mapIdsToRows(z);if(!t){a(n.mapRowsToIds(e))}o.setSelectedRows(e);i=false}}o.onSelectedRowsChanged.subscribe((function(t,l){if(i){return}var s=n.mapRowsToIds(o.getSelectedRows());if(!r||!o.getOptions().multiSelect){a(s)}else{var d=e.grep(z,(function(e){return n.getRowById(e)===undefined}));a(d.concat(s))}}));this.onRowsOrCountChanged.subscribe(s);return l}function ao(){return z}function so(){var e=[];var o=ao();o.forEach((function(o){e.push(t.getItemById(o))}));return e}function co(e,o){var r;var i;a(e.getCellCssStyles(o));function a(e){r={};for(var o in e){var t=l[o][n];r[t]=e[o]}}function d(){if(r){i=true;pe();var t={};for(var n in r){var l=s[n];if(l!=undefined){t[l]=r[n]}}e.setCellCssStyles(o,t);i=false}}e.onCellCssStylesChanged.subscribe((function(r,n){if(i){return}if(o!=n.key){return}if(n.hash){a(n.hash)}else{e.onCellCssStylesChanged.unsubscribe();t.onRowsOrCountChanged.unsubscribe(d)}}));this.onRowsOrCountChanged.subscribe(d)}e.extend(this,{beginUpdate:V,endUpdate:O,destroy:G,setPagingOptions:J,getPagingInfo:ee,getIdPropertyName:Q,getItems:K,setItems:Z,setFilter:ae,getFilter:le,getFilteredItems:ne,getFilteredItemCount:ie,sort:oe,fastSort:te,reSort:re,setGrouping:de,getGrouping:se,groupBy:ce,setAggregators:ue,collapseAllGroups:De,expandAllGroups:Me,collapseGroup:_e,expandGroup:Ve,getGroups:Oe,getAllSelectedIds:ao,getAllSelectedItems:so,getIdxById:he,getRowByItem:ve,getRowById:ge,getItemById:me,getItemByIdx:fe,mapItemsToRows:we,mapRowsToIds:Ae,mapIdsToRows:Ce,setRefreshHints:j,setFilterArgs:X,refresh:io,updateItem:$e,updateItems:Se,insertItem:be,insertItems:ke,addItem:ye,addItems:xe,deleteItem:Ee,deleteItems:Be,sortedAddItem:ze,sortedUpdateItem:Pe,syncGridSelection:lo,syncGridCellCssStyles:co,getItemCount:He,getLength:Te,getItem:Fe,getItemMetadata:We,onSetItemsCalled:T,onRowCountChanged:F,onRowsChanged:W,onRowsOrCountChanged:I,onBeforePagingInfoChanged:D,onPagingInfoChanged:M,onGroupExpanded:N,onGroupCollapsed:_})}function t(e){this.field_=e;this.init=function(){this.count_=0;this.nonNullCount_=0;this.sum_=0};this.accumulate=function(e){var o=e[this.field_];this.count_++;if(o!=null&&o!==""&&!isNaN(o)){this.nonNullCount_++;this.sum_+=parseFloat(o)}};this.storeResult=function(e){if(!e.avg){e.avg={}}if(this.nonNullCount_!==0){e.avg[this.field_]=this.sum_/this.nonNullCount_}}}function r(e){this.field_=e;this.init=function(){this.min_=null};this.accumulate=function(e){var o=e[this.field_];if(o!=null&&o!==""&&!isNaN(o)){if(this.min_==null||o<this.min_){this.min_=o}}};this.storeResult=function(e){if(!e.min){e.min={}}e.min[this.field_]=this.min_}}function n(e){this.field_=e;this.init=function(){this.max_=null};this.accumulate=function(e){var o=e[this.field_];if(o!=null&&o!==""&&!isNaN(o)){if(this.max_==null||o>this.max_){this.max_=o}}};this.storeResult=function(e){if(!e.max){e.max={}}e.max[this.field_]=this.max_}}function i(e){this.field_=e;this.init=function(){this.sum_=null};this.accumulate=function(e){var o=e[this.field_];if(o!=null&&o!==""&&!isNaN(o)){this.sum_+=parseFloat(o)}};this.storeResult=function(e){if(!e.sum){e.sum={}}e.sum[this.field_]=this.sum_}}function l(e){this.field_=e;this.init=function(){};this.storeResult=function(e){if(!e.count){e.count={}}e.count[this.field_]=e.group.rows.length}}e.extend(true,window,{Slick:{Data:{DataView:o,Aggregators:{Avg:t,Min:r,Max:n,Sum:i,Count:l}}}})})(jQuery)},33059:()=>{if(typeof jQuery==="undefined"){throw new Error("SlickGrid requires jquery module to be loaded")}if(!jQuery.fn.drag){throw new Error("SlickGrid requires jquery.event.drag module to be loaded")}if(typeof Slick==="undefined"){throw new Error("slick.core.js not loaded")}(function($){"use strict";var scrollbarDimensions;var maxSupportedCssHeight;function SlickGrid(container,data,columns,options){var defaults={alwaysShowVerticalScroll:false,alwaysAllowHorizontalScroll:false,explicitInitialization:false,rowHeight:25,defaultColumnWidth:80,enableAddRow:false,leaveSpaceForNewRows:false,editable:false,autoEdit:true,suppressActiveCellChangeOnEdit:false,enableCellNavigation:true,enableColumnReorder:true,asyncEditorLoading:false,asyncEditorLoadDelay:100,forceFitColumns:false,enableAsyncPostRender:false,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:false,asyncPostRenderCleanupDelay:40,autoHeight:false,editorLock:Slick.GlobalEditorLock,showColumnHeader:true,showHeaderRow:false,headerRowHeight:25,createFooterRow:false,showFooterRow:false,footerRowHeight:25,createPreHeaderPanel:false,showPreHeaderPanel:false,preHeaderPanelHeight:25,showTopPanel:false,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:true,enableTextSelectionOnCells:false,dataItemColumnValueExtractor:null,frozenBottom:false,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,fullWidthRows:false,multiColumnSort:false,numberedMultiColumnSort:false,tristateMultiColumnSort:false,sortColNumberInSeparateSpan:false,defaultFormatter,forceSyncScrolling:false,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:false,showCellSelection:true,viewportClass:null,minRowBuffer:3,emulatePagingWhenScrolling:true,editorCellNavOnLRKeys:false,enableMouseWheelScrollHandler:true,doPaging:true,autosizeColsMode:Slick.GridAutosizeColsMode.LegacyOff,autosizeColPaddingPx:4,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:undefined,viewportMinWidthPx:undefined,viewportMaxWidthPx:undefined,suppressCssChangesOnHiddenInit:false};var columnDefaults={name:"",resizable:true,sortable:false,minWidth:30,maxWidth:undefined,rerenderOnResize:false,headerCssClass:null,defaultSortAsc:true,focusable:true,selectable:true};var columnAutosizeDefaults={ignoreHeaderText:false,colValueArray:undefined,allowAddlPercent:undefined,formatterOverride:undefined,autosizeMode:Slick.ColAutosizeMode.ContentIntelligent,rowSelectionModeOnInit:undefined,rowSelectionMode:Slick.RowSelectionMode.FirstNRows,rowSelectionCount:100,valueFilterMode:Slick.ValueFilterMode.None,widthEvalMode:Slick.WidthEvalMode.CanvasTextSize,sizeToRemaining:undefined,widthPx:undefined,colDataTypeOf:undefined};var th;var h;var ph;var n;var cj;var page=0;var offset=0;var vScrollDir=1;var initialized=false;var $container;var uid="slickgrid_"+Math.round(1e6*Math.random());var self=this;var $focusSink,$focusSink2;var $groupHeaders=$();var $headerScroller;var $headers;var $headerRow,$headerRowScroller,$headerRowSpacerL,$headerRowSpacerR;var $footerRow,$footerRowScroller,$footerRowSpacerL,$footerRowSpacerR;var $preHeaderPanel,$preHeaderPanelScroller,$preHeaderPanelSpacer;var $preHeaderPanelR,$preHeaderPanelScrollerR,$preHeaderPanelSpacerR;var $topPanelScroller;var $topPanel;var $viewport;var $canvas;var $style;var $boundAncestors;var treeColumns;var stylesheet,columnCssRulesL,columnCssRulesR;var viewportH,viewportW;var canvasWidth,canvasWidthL,canvasWidthR;var headersWidth,headersWidthL,headersWidthR;var viewportHasHScroll,viewportHasVScroll;var headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=false;var absoluteColumnMinWidth;var hasFrozenRows=false;var frozenRowsHeight=0;var actualFrozenRow=-1;var paneTopH=0;var paneBottomH=0;var viewportTopH=0;var viewportBottomH=0;var topPanelH=0;var headerRowH=0;var footerRowH=0;var tabbingDirection=1;var $activeCanvasNode;var $activeViewportNode;var activePosX;var activeRow,activeCell;var activeCellNode=null;var currentEditor=null;var serializedEditorValue;var editController;var rowsCache={};var renderedRows=0;var numVisibleRows=0;var prevScrollTop=0;var scrollTop=0;var lastRenderedScrollTop=0;var lastRenderedScrollLeft=0;var prevScrollLeft=0;var scrollLeft=0;var selectionModel;var selectedRows=[];var plugins=[];var cellCssClasses={};var columnsById={};var sortColumns=[];var columnPosLeft=[];var columnPosRight=[];var pagingActive=false;var pagingIsLastPage=false;var scrollThrottle=ActionThrottle(render,50);var h_editorLoader=null;var h_render=null;var h_postrender=null;var h_postrenderCleanup=null;var postProcessedRows={};var postProcessToRow=null;var postProcessFromRow=null;var postProcessedCleanupQueue=[];var postProcessgroupId=0;var counter_rows_rendered=0;var counter_rows_removed=0;var $paneHeaderL;var $paneHeaderR;var $paneTopL;var $paneTopR;var $paneBottomL;var $paneBottomR;var $headerScrollerL;var $headerScrollerR;var $headerL;var $headerR;var $groupHeadersL;var $groupHeadersR;var $headerRowScrollerL;var $headerRowScrollerR;var $footerRowScrollerL;var $footerRowScrollerR;var $headerRowL;var $headerRowR;var $footerRowL;var $footerRowR;var $topPanelScrollerL;var $topPanelScrollerR;var $topPanelL;var $topPanelR;var $viewportTopL;var $viewportTopR;var $viewportBottomL;var $viewportBottomR;var $canvasTopL;var $canvasTopR;var $canvasBottomL;var $canvasBottomR;var $viewportScrollContainerX;var $viewportScrollContainerY;var $headerScrollContainer;var $headerRowScrollContainer;var $footerRowScrollContainer;var cssShow={position:"absolute",visibility:"hidden",display:"block"};var $hiddenParents;var oldProps=[];var columnResizeDragging=false;function init(){if(container instanceof jQuery){$container=container}else{$container=$(container)}if($container.length<1){throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.")}maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight();options=$.extend({},defaults,options);validateAndEnforceOptions();columnDefaults.width=options.defaultColumnWidth;if(!options.suppressCssChangesOnHiddenInit){cacheCssForHiddenInit()}treeColumns=new Slick.TreeColumns(columns);columns=treeColumns.extractColumns();updateColumnProps();if(options.enableColumnReorder&&!$.fn.sortable){throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded")}editController={commitCurrentEdit,cancelCurrentEdit};$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget");if(!/relative|absolute|fixed/.test($container.css("position"))){$container.css("position","relative")}$focusSink=$("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container);$paneHeaderL=$("<div class='slick-pane slick-pane-header slick-pane-left' tabIndex='0' />").appendTo($container);$paneHeaderR=$("<div class='slick-pane slick-pane-header slick-pane-right' tabIndex='0' />").appendTo($container);$paneTopL=$("<div class='slick-pane slick-pane-top slick-pane-left' tabIndex='0' />").appendTo($container);$paneTopR=$("<div class='slick-pane slick-pane-top slick-pane-right' tabIndex='0' />").appendTo($container);$paneBottomL=$("<div class='slick-pane slick-pane-bottom slick-pane-left' tabIndex='0' />").appendTo($container);$paneBottomR=$("<div class='slick-pane slick-pane-bottom slick-pane-right' tabIndex='0' />").appendTo($container);if(options.createPreHeaderPanel){$preHeaderPanelScroller=$("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderL);$preHeaderPanel=$("<div />").appendTo($preHeaderPanelScroller);$preHeaderPanelSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScroller);$preHeaderPanelScrollerR=$("<div class='slick-preheader-panel ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($paneHeaderR);$preHeaderPanelR=$("<div />").appendTo($preHeaderPanelScrollerR);$preHeaderPanelSpacerR=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($preHeaderPanelScrollerR);if(!options.showPreHeaderPanel){$preHeaderPanelScroller.hide();$preHeaderPanelScrollerR.hide()}}$headerScrollerL=$("<div class='slick-header ui-state-default slick-header-left' />").appendTo($paneHeaderL);$headerScrollerR=$("<div class='slick-header ui-state-default slick-header-right' />").appendTo($paneHeaderR);$headerScroller=$().add($headerScrollerL).add($headerScrollerR);if(treeColumns.hasDepth()){$groupHeadersL=[];$groupHeadersR=[];for(var e=0;e<treeColumns.getDepth()-1;e++){$groupHeadersL[e]=$("<div class='slick-group-header-columns slick-group-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL);$groupHeadersR[e]=$("<div class='slick-group-header-columns slick-group-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR)}$groupHeaders=$().add($groupHeadersL).add($groupHeadersR)}$headerL=$("<div class='slick-header-columns slick-header-columns-left' style='left:-1000px' />").appendTo($headerScrollerL);$headerR=$("<div class='slick-header-columns slick-header-columns-right' style='left:-1000px' />").appendTo($headerScrollerR);$headers=$().add($headerL).add($headerR);$headerRowScrollerL=$("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopL);$headerRowScrollerR=$("<div class='slick-headerrow ui-state-default' />").appendTo($paneTopR);$headerRowScroller=$().add($headerRowScrollerL).add($headerRowScrollerR);$headerRowSpacerL=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerL);$headerRowSpacerR=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").appendTo($headerRowScrollerR);$headerRowL=$("<div class='slick-headerrow-columns slick-headerrow-columns-left' />").appendTo($headerRowScrollerL);$headerRowR=$("<div class='slick-headerrow-columns slick-headerrow-columns-right' />").appendTo($headerRowScrollerR);$headerRow=$().add($headerRowL).add($headerRowR);$topPanelScrollerL=$("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopL);$topPanelScrollerR=$("<div class='slick-top-panel-scroller ui-state-default' />").appendTo($paneTopR);$topPanelScroller=$().add($topPanelScrollerL).add($topPanelScrollerR);$topPanelL=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerL);$topPanelR=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScrollerR);$topPanel=$().add($topPanelL).add($topPanelR);if(!options.showColumnHeader){$headerScroller.hide()}if(!options.showTopPanel){$topPanelScroller.hide()}if(!options.showHeaderRow){$headerRowScroller.hide()}$viewportTopL=$("<div class='slick-viewport slick-viewport-top slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneTopL);$viewportTopR=$("<div class='slick-viewport slick-viewport-top slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneTopR);$viewportBottomL=$("<div class='slick-viewport slick-viewport-bottom slick-viewport-left' tabIndex='0' hideFocus />").appendTo($paneBottomL);$viewportBottomR=$("<div class='slick-viewport slick-viewport-bottom slick-viewport-right' tabIndex='0' hideFocus />").appendTo($paneBottomR);$viewport=$().add($viewportTopL).add($viewportTopR).add($viewportBottomL).add($viewportBottomR);$activeViewportNode=$viewportTopL;$canvasTopL=$("<div class='grid-canvas grid-canvas-top grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportTopL);$canvasTopR=$("<div class='grid-canvas grid-canvas-top grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportTopR);$canvasBottomL=$("<div class='grid-canvas grid-canvas-bottom grid-canvas-left' tabIndex='0' hideFocus />").appendTo($viewportBottomL);$canvasBottomR=$("<div class='grid-canvas grid-canvas-bottom grid-canvas-right' tabIndex='0' hideFocus />").appendTo($viewportBottomR);if(options.viewportClass)$viewport.toggleClass(options.viewportClass,true);$canvas=$().add($canvasTopL).add($canvasTopR).add($canvasBottomL).add($canvasBottomR);scrollbarDimensions=scrollbarDimensions||measureScrollbar();$activeCanvasNode=$canvasTopL;if($preHeaderPanelSpacer)$preHeaderPanelSpacer.css("width",getCanvasWidth()+scrollbarDimensions.width+"px");$headers.width(getHeadersWidth());$headerRowSpacerL.css("width",getCanvasWidth()+scrollbarDimensions.width+"px");$headerRowSpacerR.css("width",getCanvasWidth()+scrollbarDimensions.width+"px");if(options.createFooterRow){$footerRowScrollerR=$("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopR);$footerRowScrollerL=$("<div class='slick-footerrow ui-state-default' />").appendTo($paneTopL);$footerRowScroller=$().add($footerRowScrollerL).add($footerRowScrollerR);$footerRowSpacerL=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerL);$footerRowSpacerR=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScrollerR);$footerRowL=$("<div class='slick-footerrow-columns slick-footerrow-columns-left' />").appendTo($footerRowScrollerL);$footerRowR=$("<div class='slick-footerrow-columns slick-footerrow-columns-right' />").appendTo($footerRowScrollerR);$footerRow=$().add($footerRowL).add($footerRowR);if(!options.showFooterRow){$footerRowScroller.hide()}}$focusSink2=$focusSink.clone().appendTo($container);if(!options.explicitInitialization){finishInitialization()}}function finishInitialization(){if(!initialized){initialized=true;getViewportWidth();getViewportHeight();measureCellPaddingAndBorder();disableSelection($headers);if(!options.enableTextSelectionOnCells){$viewport.on("selectstart.ui",(function(e){return $(e.target).is("input,textarea")}))}setFrozenOptions();setPaneVisibility();setScroller();setOverflow();updateColumnCaches();createColumnHeaders();createColumnGroupHeaders();createColumnFooter();setupColumnSort();createCssRules();resizeCanvas();bindAncestorScrollEvents();$container.on("resize.slickgrid",resizeCanvas);$viewport.on("scroll",handleScroll);if(jQuery.fn.mousewheel&&options.enableMouseWheelScrollHandler){$viewport.on("mousewheel",handleMouseWheel)}$headerScroller.on("contextmenu",handleHeaderContextMenu).on("click",handleHeaderClick).on("mouseenter",".slick-header-column",handleHeaderMouseEnter).on("mouseleave",".slick-header-column",handleHeaderMouseLeave);$headerRowScroller.on("scroll",handleHeaderRowScroll);if(options.showHeaderRow){$headerRow.on("mouseenter",".slick-headerrow-column",handleHeaderRowMouseEnter).on("mouseleave",".slick-headerrow-column",handleHeaderRowMouseLeave)}if(options.createFooterRow){$footerRow.on("contextmenu",handleFooterContextMenu).on("click",handleFooterClick);$footerRowScroller.on("scroll",handleFooterRowScroll)}if(options.createPreHeaderPanel){$preHeaderPanelScroller.on("scroll",handlePreHeaderPanelScroll)}$focusSink.add($focusSink2).on("keydown",handleKeyDown);$canvas.on("keydown",handleKeyDown).on("click",handleClick).on("dblclick",handleDblClick).on("contextmenu",handleContextMenu).on("draginit",handleDragInit).on("dragstart",{distance:3},handleDragStart).on("drag",handleDrag).on("dragend",handleDragEnd).on("mouseenter",".slick-cell",handleMouseEnter).on("mouseleave",".slick-cell",handleMouseLeave);if(!options.suppressCssChangesOnHiddenInit){restoreCssFromHiddenInit()}}}function cacheCssForHiddenInit(){$hiddenParents=$container.parents().addBack().not(":visible");$hiddenParents.each((function(){var e={};for(var o in cssShow){e[o]=this.style[o];this.style[o]=cssShow[o]}oldProps.push(e)}))}function restoreCssFromHiddenInit(){$hiddenParents.each((function(e){var o=oldProps[e];for(var t in cssShow){this.style[t]=o[t]}}))}function hasFrozenColumns(){return options.frozenColumn>-1}function registerPlugin(e){plugins.unshift(e);e.init(self)}function unregisterPlugin(e){for(var o=plugins.length;o>=0;o--){if(plugins[o]===e){if(plugins[o].destroy){plugins[o].destroy()}plugins.splice(o,1);break}}}function getPluginByName(e){for(var o=plugins.length-1;o>=0;o--){if(plugins[o].pluginName===e){return plugins[o]}}return undefined}function setSelectionModel(e){if(selectionModel){selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged);if(selectionModel.destroy){selectionModel.destroy()}}selectionModel=e;if(selectionModel){selectionModel.init(self);selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged)}}function getSelectionModel(){return selectionModel}function getCanvasNode(e,o){return _getContainerElement(getCanvases(),e,o)}function getActiveCanvasNode(e){setActiveCanvasNode(e);return $activeCanvasNode[0]}function getCanvases(){return $canvas}function setActiveCanvasNode(e){if(e){$activeCanvasNode=$(e.target).closest(".grid-canvas")}}function getViewportNode(e,o){return _getContainerElement(getViewports(),e,o)}function getViewports(){return $viewport}function getActiveViewportNode(e){setActiveViewportNode(e);return $activeViewportNode[0]}function setActiveViewportNode(e){if(e){$activeViewportNode=$(e.target).closest(".slick-viewport")}}function _getContainerElement(e,o,t){if(!e){return}if(!o){o=0}if(!t){t=0}var r=typeof o==="number"?o:getColumnIndex(o);var n=hasFrozenRows&&t>=actualFrozenRow+(options.frozenBottom?0:1);var i=hasFrozenColumns()&&r>options.frozenColumn;return e[(n?2:0)+(i?1:0)]}function measureScrollbar(){var e=$('<div class="'+$viewport.className+'" style="position:absolute; top:-10000px; left:-10000px; overflow:auto; width:100px; height:100px;"></div>').appendTo("body");var o=$('<div style="width:200px; height:200px; overflow:auto;"></div>').appendTo(e);var t={width:e[0].offsetWidth-e[0].clientWidth,height:e[0].offsetHeight-e[0].clientHeight};o.remove();e.remove();return t}function getHeadersWidth(){headersWidth=headersWidthL=headersWidthR=0;var e=!options.autoHeight;for(var o=0,t=columns.length;o<t;o++){var r=columns[o].width;if(options.frozenColumn>-1&&o>options.frozenColumn){headersWidthR+=r}else{headersWidthL+=r}}if(e){if(options.frozenColumn>-1&&o>options.frozenColumn){headersWidthR+=scrollbarDimensions.width}else{headersWidthL+=scrollbarDimensions.width}}if(hasFrozenColumns()){headersWidthL=headersWidthL+1e3;headersWidthR=Math.max(headersWidthR,viewportW)+headersWidthL;headersWidthR+=scrollbarDimensions.width}else{headersWidthL+=scrollbarDimensions.width;headersWidthL=Math.max(headersWidthL,viewportW)+1e3}headersWidth=headersWidthL+headersWidthR;return Math.max(headersWidth,viewportW)+1e3}function getHeadersWidthL(){headersWidthL=0;columns.forEach((function(e,o){if(!(options.frozenColumn>-1&&o>options.frozenColumn))headersWidthL+=e.width}));if(hasFrozenColumns()){headersWidthL+=1e3}else{headersWidthL+=scrollbarDimensions.width;headersWidthL=Math.max(headersWidthL,viewportW)+1e3}return headersWidthL}function getHeadersWidthR(){headersWidthR=0;columns.forEach((function(e,o){if(options.frozenColumn>-1&&o>options.frozenColumn)headersWidthR+=e.width}));if(hasFrozenColumns()){headersWidthR=Math.max(headersWidthR,viewportW)+getHeadersWidthL();headersWidthR+=scrollbarDimensions.width}return headersWidthR}function getCanvasWidth(){var e=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;var o=columns.length;canvasWidthL=canvasWidthR=0;while(o--){if(hasFrozenColumns()&&o>options.frozenColumn){canvasWidthR+=columns[o].width}else{canvasWidthL+=columns[o].width}}var t=canvasWidthL+canvasWidthR;return options.fullWidthRows?Math.max(t,e):t}function updateCanvasWidth(e){var o=canvasWidth;var t=canvasWidthL;var r=canvasWidthR;var n;canvasWidth=getCanvasWidth();n=canvasWidth!==o||canvasWidthL!==t||canvasWidthR!==r;if(n||hasFrozenColumns()||hasFrozenRows){$canvasTopL.width(canvasWidthL);getHeadersWidth();$headerL.width(headersWidthL);$headerR.width(headersWidthR);if(hasFrozenColumns()){$canvasTopR.width(canvasWidthR);$paneHeaderL.width(canvasWidthL);$paneHeaderR.css("left",canvasWidthL);$paneHeaderR.css("width",viewportW-canvasWidthL);$paneTopL.width(canvasWidthL);$paneTopR.css("left",canvasWidthL);$paneTopR.css("width",viewportW-canvasWidthL);$headerRowScrollerL.width(canvasWidthL);$headerRowScrollerR.width(viewportW-canvasWidthL);$headerRowL.width(canvasWidthL);$headerRowR.width(canvasWidthR);if(options.createFooterRow){$footerRowScrollerL.width(canvasWidthL);$footerRowScrollerR.width(viewportW-canvasWidthL);$footerRowL.width(canvasWidthL);$footerRowR.width(canvasWidthR)}if(options.createPreHeaderPanel){$preHeaderPanel.width(canvasWidth)}$viewportTopL.width(canvasWidthL);$viewportTopR.width(viewportW-canvasWidthL);if(hasFrozenRows){$paneBottomL.width(canvasWidthL);$paneBottomR.css("left",canvasWidthL);$viewportBottomL.width(canvasWidthL);$viewportBottomR.width(viewportW-canvasWidthL);$canvasBottomL.width(canvasWidthL);$canvasBottomR.width(canvasWidthR)}}else{$paneHeaderL.width("100%");$paneTopL.width("100%");$headerRowScrollerL.width("100%");$headerRowL.width(canvasWidth);if(options.createFooterRow){$footerRowScrollerL.width("100%");$footerRowL.width(canvasWidth)}if(options.createPreHeaderPanel){$preHeaderPanel.width("100%");$preHeaderPanel.width(canvasWidth)}$viewportTopL.width("100%");if(hasFrozenRows){$viewportBottomL.width("100%");$canvasBottomL.width(canvasWidthL)}}viewportHasHScroll=canvasWidth>=viewportW-scrollbarDimensions.width}$headerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0));$headerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0));if(options.createFooterRow){$footerRowSpacerL.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0));$footerRowSpacerR.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0))}if(n||e){applyColumnWidths()}}function disableSelection(e){if(e&&e.jquery){e.attr("unselectable","on").css("MozUserSelect","none").on("selectstart.ui",(function(){return false}))}}function getMaxSupportedCssHeight(){var e=1e6;var o=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9;var t=$("<div style='display:none' />").appendTo(document.body);while(true){var r=e*2;t.css("height",r);if(r>o||t.height()!==r){break}else{e=r}}t.remove();return e}function getUID(){return uid}function getHeaderColumnWidthDiff(){return headerColumnWidthDiff}function getScrollbarDimensions(){return scrollbarDimensions}function getDisplayedScrollbarDimensions(){return{width:viewportHasVScroll?scrollbarDimensions.width:0,height:viewportHasHScroll?scrollbarDimensions.height:0}}function getAbsoluteColumnMinWidth(){return absoluteColumnMinWidth}function bindAncestorScrollEvents(){var e=hasFrozenRows&&!options.frozenBottom?$canvasBottomL[0]:$canvasTopL[0];while((e=e.parentNode)!=document.body&&e!=null){if(e==$viewportTopL[0]||e.scrollWidth!=e.clientWidth||e.scrollHeight!=e.clientHeight){var o=$(e);if(!$boundAncestors){$boundAncestors=o}else{$boundAncestors=$boundAncestors.add(o)}o.on("scroll."+uid,handleActiveCellPositionChange)}}}function unbindAncestorScrollEvents(){if(!$boundAncestors){return}$boundAncestors.off("scroll."+uid);$boundAncestors=null}function updateColumnHeader(e,o,t){if(!initialized){return}var r=getColumnIndex(e);if(r==null){return}var n=columns[r];var i=$headers.children().eq(r);if(i){if(o!==undefined){columns[r].name=o}if(t!==undefined){columns[r].toolTip=t}trigger(self.onBeforeHeaderCellDestroy,{node:i[0],column:n,grid:self});i.attr("title",t||"").children().eq(0).html(o);trigger(self.onHeaderCellRendered,{node:i[0],column:n,grid:self})}}function getHeader(e){if(!e){return hasFrozenColumns()?$headers:$headerL}var o=getColumnIndex(e.id);return hasFrozenColumns()?o<=options.frozenColumn?$headerL:$headerR:$headerL}function getHeaderColumn(e){var o=typeof e==="number"?e:getColumnIndex(e);var t=hasFrozenColumns()?o<=options.frozenColumn?$headerL:$headerR:$headerL;var r=hasFrozenColumns()?o<=options.frozenColumn?o:o-options.frozenColumn-1:o;var n=t.children().eq(r);return n&&n[0]}function getHeaderRow(){return hasFrozenColumns()?$headerRow:$headerRow[0]}function getFooterRow(){return hasFrozenColumns()?$footerRow:$footerRow[0]}function getPreHeaderPanel(){return $preHeaderPanel[0]}function getPreHeaderPanelRight(){return $preHeaderPanelR[0]}function getHeaderRowColumn(e){var o=typeof e==="number"?e:getColumnIndex(e);var t;if(hasFrozenColumns()){if(o<=options.frozenColumn){t=$headerRowL}else{t=$headerRowR;o-=options.frozenColumn+1}}else{t=$headerRowL}var r=t.children().eq(o);return r&&r[0]}function getFooterRowColumn(e){var o=typeof e==="number"?e:getColumnIndex(e);var t;if(hasFrozenColumns()){if(o<=options.frozenColumn){t=$footerRowL}else{t=$footerRowR;o-=options.frozenColumn+1}}else{t=$footerRowL}var r=t&&t.children().eq(o);return r&&r[0]}function createColumnFooter(){if(options.createFooterRow){$footerRow.find(".slick-footerrow-column").each((function(){var e=$(this).data("column");if(e){trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})}}));$footerRowL.empty();$footerRowR.empty();for(var e=0;e<columns.length;e++){var o=columns[e];var t=$("<div class='ui-state-default slick-footerrow-column l"+e+" r"+e+"'></div>").data("column",o).addClass(hasFrozenColumns()&&e<=options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e>options.frozenColumn?$footerRowR:$footerRowL);trigger(self.onFooterRowCellRendered,{node:t[0],column:o,grid:self})}}}function createColumnGroupHeaders(){var e=0;var o=false;if(!treeColumns.hasDepth())return;for(var t=0;t<$groupHeadersL.length;t++){$groupHeadersL[t].empty();$groupHeadersR[t].empty();var r=treeColumns.getColumnsInDepth(t);for(var n in r){var i=r[n];e+=i.extractColumns().length;if(hasFrozenColumns()&&t===0&&e-1===options.frozenColumn)o=true;$("<div class='ui-state-default slick-group-header-column' />").html("<span class='slick-column-name'>"+i.name+"</span>").attr("id",""+uid+i.id).attr("title",i.toolTip||"").data("column",i).addClass(i.headerCssClass||"").addClass(hasFrozenColumns()&&e-1>options.frozenColumn?"frozen":"").appendTo(hasFrozenColumns()&&e-1>options.frozenColumn?$groupHeadersR[t]:$groupHeadersL[t])}if(hasFrozenColumns()&&t===0&&!o){$groupHeadersL[t].empty();$groupHeadersR[t].empty();alert("All columns of group should to be grouped!");break}}applyColumnGroupHeaderWidths()}function createColumnHeaders(){function e(){$(this).addClass("ui-state-hover")}function o(){$(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each((function(){var e=$(this).data("column");if(e){trigger(self.onBeforeHeaderCellDestroy,{node:this,column:e,grid:self})}}));$headerL.empty();$headerR.empty();getHeadersWidth();$headerL.width(headersWidthL);$headerR.width(headersWidthR);$headerRow.find(".slick-headerrow-column").each((function(){var e=$(this).data("column");if(e){trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:e,grid:self})}}));$headerRowL.empty();$headerRowR.empty();if(options.createFooterRow){$footerRowL.find(".slick-footerrow-column").each((function(){var e=$(this).data("column");if(e){trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})}}));$footerRowL.empty();if(hasFrozenColumns()){$footerRowR.find(".slick-footerrow-column").each((function(){var e=$(this).data("column");if(e){trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:self})}}));$footerRowR.empty()}}for(var t=0;t<columns.length;t++){var r=columns[t];var n=hasFrozenColumns()?t<=options.frozenColumn?$headerL:$headerR:$headerL;var i=hasFrozenColumns()?t<=options.frozenColumn?$headerRowL:$headerRowR:$headerRowL;var l=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+r.name+"</span>").width(r.width-headerColumnWidthDiff).attr("id",""+uid+r.id).attr("title",r.toolTip||"").data("column",r).addClass(r.headerCssClass||"").addClass(hasFrozenColumns()&&t<=options.frozenColumn?"frozen":"").appendTo(n);if(options.enableColumnReorder||r.sortable){l.on("mouseenter",e).on("mouseleave",o)}if(r.hasOwnProperty("headerCellAttrs")&&r.headerCellAttrs instanceof Object){for(var a in r.headerCellAttrs){if(r.headerCellAttrs.hasOwnProperty(a)){l.attr(a,r.headerCellAttrs[a])}}}if(r.sortable){l.addClass("slick-header-sortable");l.append("<span class='slick-sort-indicator"+(options.numberedMultiColumnSort&&!options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")+"' />");if(options.numberedMultiColumnSort&&options.sortColNumberInSeparateSpan){l.append("<span class='slick-sort-indicator-numbered' />")}}trigger(self.onHeaderCellRendered,{node:l[0],column:r,grid:self});if(options.showHeaderRow){var s=$("<div class='ui-state-default slick-headerrow-column l"+t+" r"+t+"'></div>").data("column",r).addClass(hasFrozenColumns()&&t<=options.frozenColumn?"frozen":"").appendTo(i);trigger(self.onHeaderRowCellRendered,{node:s[0],column:r,grid:self})}if(options.createFooterRow&&options.showFooterRow){var d=$("<div class='ui-state-default slick-footerrow-column l"+t+" r"+t+"'></div>").data("column",r).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:d[0],column:r,grid:self})}}setSortColumns(sortColumns);setupColumnResize();if(options.enableColumnReorder){if(typeof options.enableColumnReorder=="function"){options.enableColumnReorder(self,$headers,headerColumnWidthDiff,setColumns,setupColumnResize,columns,getColumnIndex,uid,trigger)}else{setupColumnReorder()}}}function setupColumnSort(){$headers.click((function(e){if(columnResizeDragging)return;e.metaKey=e.metaKey||e.ctrlKey;if($(e.target).hasClass("slick-resizable-handle")){return}var o=$(e.target).closest(".slick-header-column");if(!o.length){return}var t=o.data("column");if(t.sortable){if(!getEditorLock().commitCurrentEdit()){return}var r=$.extend(true,[],sortColumns);var n=null;var i=0;for(;i<sortColumns.length;i++){if(sortColumns[i].columnId==t.id){n=sortColumns[i];n.sortAsc=!n.sortAsc;break}}var l=!!n;if(options.tristateMultiColumnSort){if(!n){n={columnId:t.id,sortAsc:t.defaultSortAsc}}if(l&&n.sortAsc){sortColumns.splice(i,1);n=null}if(!options.multiColumnSort){sortColumns=[]}if(n&&(!l||!options.multiColumnSort)){sortColumns.push(n)}}else{if(e.metaKey&&options.multiColumnSort){if(n){sortColumns.splice(i,1)}}else{if(!e.shiftKey&&!e.metaKey||!options.multiColumnSort){sortColumns=[]}if(!n){n={columnId:t.id,sortAsc:t.defaultSortAsc};sortColumns.push(n)}else if(sortColumns.length===0){sortColumns.push(n)}}}var a;if(!options.multiColumnSort){a={multiColumnSort:false,previousSortColumns:r,columnId:sortColumns.length>0?t.id:null,sortCol:sortColumns.length>0?t:null,sortAsc:sortColumns.length>0?sortColumns[0].sortAsc:true}}else{a={multiColumnSort:true,previousSortColumns:r,sortCols:$.map(sortColumns,(function(e){return{columnId:columns[getColumnIndex(e.columnId)].id,sortCol:columns[getColumnIndex(e.columnId)],sortAsc:e.sortAsc}}))}}if(trigger(self.onBeforeSort,a,e)!==false){setSortColumns(sortColumns);trigger(self.onSort,a,e)}}}))}function currentPositionInHeader(e){var o=0;$headers.find(".slick-header-column").each((function(t){if(this.id==e){o=t;return false}}));return o}function limitPositionInGroup(e){var o,t=0,r=0;treeColumns.getColumnsInDepth($groupHeadersL.length-1).some((function(n){t=r;r+=n.columns.length;n.columns.some((function(t){if(t.id===e)o=n;return o}));return o}));r--;return{start:t,end:r,group:o}}function remove(e,o){var t=e.lastIndexOf(o);if(t>-1){e.splice(t,1);remove(e,o)}}function columnPositionValidInGroup(e){var o=currentPositionInHeader(e[0].id);var t=limitPositionInGroup(e.data("column").id);var r=t.start<=o&&o<=t.end;return{limit:t,valid:r,message:r?"":'Column "'.concat(e.text(),'" can be reordered only within the "',t.group.name,'" group!')}}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy");var e=null;function o(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft+10}function t(){$viewportScrollContainerX[0].scrollLeft=$viewportScrollContainerX[0].scrollLeft-10}var r;$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",start:function(e,o){o.placeholder.width(o.helper.outerWidth()-headerColumnWidthDiff);r=!hasFrozenColumns()||o.placeholder.offset().left+o.placeholder.width()>$viewportScrollContainerX.offset().left;$(o.helper).addClass("slick-header-column-active")},beforeStop:function(e,o){$(o.helper).removeClass("slick-header-column-active")},sort:function(n,i){if(r&&n.originalEvent.pageX>$container[0].clientWidth){if(!e){e=setInterval(o,100)}}else if(r&&n.originalEvent.pageX<$viewportScrollContainerX.offset().left){if(!e){e=setInterval(t,100)}}else{clearInterval(e);e=null}},stop:function(o,t){var r=false;clearInterval(e);e=null;var n=null;if(treeColumns.hasDepth()){var i=columnPositionValidInGroup(t.item);n=i.limit;r=!i.valid;if(r)alert(i.message)}if(r||!getEditorLock().commitCurrentEdit()){$(this).sortable("cancel");return}var l=$headerL.sortable("toArray");l=l.concat($headerR.sortable("toArray"));var a=[];for(var s=0;s<l.length;s++){a.push(columns[getColumnIndex(l[s].replace(uid,""))])}setColumns(a);trigger(self.onColumnsReordered,{impactedColumns:getImpactedColumns(n)});o.stopPropagation();setupColumnResize()}})}function getImpactedColumns(e){var o=[];if(e){for(var t=e.start;t<=e.end;t++){o.push(columns[t])}}else{o=columns}return o}function setupColumnResize(){var e,o,t,r,n,i,l,a,s,d;var c=0;i=$headers.children();i.find(".slick-resizable-handle").remove();i.each((function(e,o){if(e>=columns.length){return}if(columns[e].resizable){if(s===undefined){s=e}d=e}}));if(s===undefined){return}i.each((function(u,f){if(u>=columns.length){return}if(u<s||options.forceFitColumns&&u>=d){return}e=$(f);$("<div class='slick-resizable-handle' />").appendTo(f).on("dragstart",(function(e,t){if(!getEditorLock().commitCurrentEdit()){return false}n=e.pageX;c=0;$(this).parent().addClass("slick-header-column-active");var s=null,d=null;i.each((function(e,o){if(e>=columns.length){return}columns[e].previousWidth=$(o).outerWidth()}));if(options.forceFitColumns){s=0;d=0;for(o=u+1;o<columns.length;o++){r=columns[o];if(r.resizable){if(d!==null){if(r.maxWidth){d+=r.maxWidth-r.previousWidth}else{d=null}}s+=r.previousWidth-Math.max(r.minWidth||0,absoluteColumnMinWidth)}}}var f=0,h=0;for(o=0;o<=u;o++){r=columns[o];if(r.resizable){if(h!==null){if(r.maxWidth){h+=r.maxWidth-r.previousWidth}else{h=null}}f+=r.previousWidth-Math.max(r.minWidth||0,absoluteColumnMinWidth)}}if(s===null){s=1e5}if(f===null){f=1e5}if(d===null){d=1e5}if(h===null){h=1e5}a=n+Math.min(s,h);l=n-Math.min(f,d)})).on("drag",(function(e,i){columnResizeDragging=true;var s,d=Math.min(a,Math.max(l,e.pageX))-n,f;var h=0,p=0;var v=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;if(d<0){f=d;for(o=u;o>=0;o--){r=columns[o];if(r.resizable){s=Math.max(r.minWidth||0,absoluteColumnMinWidth);if(f&&r.previousWidth+f<s){f+=r.previousWidth-s;r.width=s}else{r.width=r.previousWidth+f;f=0}}}for(t=0;t<=u;t++){r=columns[t];if(hasFrozenColumns()&&t>options.frozenColumn){p+=r.width}else{h+=r.width}}if(options.forceFitColumns){f=-d;for(o=u+1;o<columns.length;o++){r=columns[o];if(r.resizable){if(f&&r.maxWidth&&r.maxWidth-r.previousWidth<f){f-=r.maxWidth-r.previousWidth;r.width=r.maxWidth}else{r.width=r.previousWidth+f;f=0}if(hasFrozenColumns()&&o>options.frozenColumn){p+=r.width}else{h+=r.width}}}}else{for(o=u+1;o<columns.length;o++){r=columns[o];if(hasFrozenColumns()&&o>options.frozenColumn){p+=r.width}else{h+=r.width}}}if(options.forceFitColumns){f=-d;for(o=u+1;o<columns.length;o++){r=columns[o];if(r.resizable){if(f&&r.maxWidth&&r.maxWidth-r.previousWidth<f){f-=r.maxWidth-r.previousWidth;r.width=r.maxWidth}else{r.width=r.previousWidth+f;f=0}}}}}else{f=d;h=0;p=0;for(o=u;o>=0;o--){r=columns[o];if(r.resizable){if(f&&r.maxWidth&&r.maxWidth-r.previousWidth<f){f-=r.maxWidth-r.previousWidth;r.width=r.maxWidth}else{var g=r.previousWidth+f;var m=canvasWidthL+f;if(hasFrozenColumns()&&o<=options.frozenColumn){if(g>c&&m<v-options.frozenRightViewportMinWidth){c=g}r.width=m+options.frozenRightViewportMinWidth>v?c:g}else{r.width=g}f=0}}}for(t=0;t<=u;t++){r=columns[t];if(hasFrozenColumns()&&t>options.frozenColumn){p+=r.width}else{h+=r.width}}if(options.forceFitColumns){f=-d;for(o=u+1;o<columns.length;o++){r=columns[o];if(r.resizable){s=Math.max(r.minWidth||0,absoluteColumnMinWidth);if(f&&r.previousWidth+f<s){f+=r.previousWidth-s;r.width=s}else{r.width=r.previousWidth+f;f=0}if(hasFrozenColumns()&&o>options.frozenColumn){p+=r.width}else{h+=r.width}}}}else{for(o=u+1;o<columns.length;o++){r=columns[o];if(hasFrozenColumns()&&o>options.frozenColumn){p+=r.width}else{h+=r.width}}}}if(hasFrozenColumns()&&h!=canvasWidthL){$headerL.width(h+1e3);$paneHeaderR.css("left",h)}applyColumnHeaderWidths();applyColumnGroupHeaderWidths();if(options.syncColumnCellResize){applyColumnWidths()}trigger(self.onColumnsDrag,{triggeredByColumn:$(this).parent().attr("id").replace(uid,""),resizeHandle:$(this)})})).on("dragend",(function(e,t){$(this).parent().removeClass("slick-header-column-active");var n=$(this).parent().attr("id").replace(uid,"");if(trigger(self.onBeforeColumnsResize,{triggeredByColumn:n})===true){applyColumnHeaderWidths();applyColumnGroupHeaderWidths()}var l;for(o=0;o<columns.length;o++){r=columns[o];l=$(i[o]).outerWidth();if(r.previousWidth!==l&&r.rerenderOnResize){invalidateAllRows()}}updateCanvasWidth(true);render();trigger(self.onColumnsResized,{triggeredByColumn:n});setTimeout((function(){columnResizeDragging=false}),300)})).on("dblclick",(function(){var e=$(this).parent().attr("id").replace(uid,"");trigger(self.onColumnsResizeDblClick,{triggeredByColumn:e})}))}))}function getVBoxDelta(e){var o=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];var t=0;if(e&&typeof e.css==="function"){$.each(o,(function(o,r){t+=parseFloat(e.css(r))||0}))}return t}function setFrozenOptions(){options.frozenColumn=options.frozenColumn>=0&&options.frozenColumn<columns.length?parseInt(options.frozenColumn):-1;if(options.frozenRow>-1){hasFrozenRows=true;frozenRowsHeight=options.frozenRow*options.rowHeight;var e=getDataLength();actualFrozenRow=options.frozenBottom?e-options.frozenRow:options.frozenRow}else{hasFrozenRows=false}}function setPaneVisibility(){if(hasFrozenColumns()){$paneHeaderR.show();$paneTopR.show();if(hasFrozenRows){$paneBottomL.show();$paneBottomR.show()}else{$paneBottomR.hide();$paneBottomL.hide()}}else{$paneHeaderR.hide();$paneTopR.hide();$paneBottomR.hide();if(hasFrozenRows){$paneBottomL.show()}else{$paneBottomR.hide();$paneBottomL.hide()}}}function setOverflow(){$viewportTopL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?hasFrozenRows?"hidden":"hidden":hasFrozenRows?"scroll":"auto"});$viewportTopR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"scroll":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"hidden":"auto","overflow-y":options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?hasFrozenRows?"scroll":"auto":hasFrozenRows?"scroll":"auto"});$viewportBottomL.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"auto":"auto","overflow-y":!hasFrozenColumns()&&options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?hasFrozenRows?"hidden":"hidden":hasFrozenRows?"scroll":"auto"});$viewportBottomR.css({"overflow-x":hasFrozenColumns()?hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"scroll":"auto":hasFrozenRows&&!options.alwaysAllowHorizontalScroll?"auto":"auto","overflow-y":options.alwaysShowVerticalScroll?"scroll":hasFrozenColumns()?hasFrozenRows?"auto":"auto":hasFrozenRows?"auto":"auto"});if(options.viewportClass){$viewportTopL.toggleClass(options.viewportClass,true);$viewportTopR.toggleClass(options.viewportClass,true);$viewportBottomL.toggleClass(options.viewportClass,true);$viewportBottomR.toggleClass(options.viewportClass,true)}}function setScroller(){if(hasFrozenColumns()){$headerScrollContainer=$headerScrollerR;$headerRowScrollContainer=$headerRowScrollerR;$footerRowScrollContainer=$footerRowScrollerR;if(hasFrozenRows){if(options.frozenBottom){$viewportScrollContainerX=$viewportBottomR;$viewportScrollContainerY=$viewportTopR}else{$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomR}}else{$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopR}}else{$headerScrollContainer=$headerScrollerL;$headerRowScrollContainer=$headerRowScrollerL;$footerRowScrollContainer=$footerRowScrollerL;if(hasFrozenRows){if(options.frozenBottom){$viewportScrollContainerX=$viewportBottomL;$viewportScrollContainerY=$viewportTopL}else{$viewportScrollContainerX=$viewportScrollContainerY=$viewportBottomL}}else{$viewportScrollContainerX=$viewportScrollContainerY=$viewportTopL}}}function measureCellPaddingAndBorder(){var e;var o=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];var t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];var r=$.fn.jquery.split(".");jQueryNewWidthBehaviour=r[0]==1&&r[1]>=8||r[0]>=2;e=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers);headerColumnWidthDiff=headerColumnHeightDiff=0;if(e.css("box-sizing")!="border-box"&&e.css("-moz-box-sizing")!="border-box"&&e.css("-webkit-box-sizing")!="border-box"){$.each(o,(function(o,t){headerColumnWidthDiff+=parseFloat(e.css(t))||0}));$.each(t,(function(o,t){headerColumnHeightDiff+=parseFloat(e.css(t))||0}))}e.remove();var n=$("<div class='slick-row' />").appendTo($canvas);e=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(n);cellWidthDiff=cellHeightDiff=0;if(e.css("box-sizing")!="border-box"&&e.css("-moz-box-sizing")!="border-box"&&e.css("-webkit-box-sizing")!="border-box"){$.each(o,(function(o,t){cellWidthDiff+=parseFloat(e.css(t))||0}));$.each(t,(function(o,t){cellHeightDiff+=parseFloat(e.css(t))||0}))}n.remove();absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));var e=options.rowHeight-cellHeightDiff;var o=["."+uid+" .slick-group-header-column { left: 1000px; }","."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-preheader-panel { height:"+options.preHeaderPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-footerrow-columns { height:"+options.footerRowHeight+"px; }","."+uid+" .slick-cell { height:"+e+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"];for(var t=0;t<columns.length;t++){o.push("."+uid+" .l"+t+" { }");o.push("."+uid+" .r"+t+" { }")}if($style[0].styleSheet){$style[0].styleSheet.cssText=o.join(" ")}else{$style[0].appendChild(document.createTextNode(o.join(" ")))}}function getColumnCssRules(e){var o;if(!stylesheet){var t=document.styleSheets;for(o=0;o<t.length;o++){if((t[o].ownerNode||t[o].owningElement)==$style[0]){stylesheet=t[o];break}}if(!stylesheet){throw new Error("SlickGrid Cannot find stylesheet.")}columnCssRulesL=[];columnCssRulesR=[];var r=stylesheet.cssRules||stylesheet.rules;var n,i;for(o=0;o<r.length;o++){var l=r[o].selectorText;if(n=/\.l\d+/.exec(l)){i=parseInt(n[0].substr(2,n[0].length-2),10);columnCssRulesL[i]=r[o]}else if(n=/\.r\d+/.exec(l)){i=parseInt(n[0].substr(2,n[0].length-2),10);columnCssRulesR[i]=r[o]}}}return{left:columnCssRulesL[e],right:columnCssRulesR[e]}}function removeCssRules(){$style.remove();stylesheet=null}function destroy(e){getEditorLock().cancelCurrentEdit();trigger(self.onBeforeDestroy,{});var o=plugins.length;while(o--){unregisterPlugin(plugins[o])}if(options.enableColumnReorder){$headers.filter(":ui-sortable").sortable("destroy")}unbindAncestorScrollEvents();$container.off(".slickgrid");removeCssRules();$canvas.off();$viewport.off();$headerScroller.off();$headerRowScroller.off();if($footerRow){$footerRow.off()}if($footerRowScroller){$footerRowScroller.off()}if($preHeaderPanelScroller){$preHeaderPanelScroller.off()}$focusSink.off();$(".slick-resizable-handle").off();$(".slick-header-column").off();$container.empty().removeClass(uid);if(e){destroyAllElements()}}function destroyAllElements(){$activeCanvasNode=null;$activeViewportNode=null;$boundAncestors=null;$canvas=null;$canvasTopL=null;$canvasTopR=null;$canvasBottomL=null;$canvasBottomR=null;$container=null;$focusSink=null;$focusSink2=null;$groupHeaders=null;$groupHeadersL=null;$groupHeadersR=null;$headerL=null;$headerR=null;$headers=null;$headerRow=null;$headerRowL=null;$headerRowR=null;$headerRowSpacerL=null;$headerRowSpacerR=null;$headerRowScrollContainer=null;$headerRowScroller=null;$headerRowScrollerL=null;$headerRowScrollerR=null;$headerScrollContainer=null;$headerScroller=null;$headerScrollerL=null;$headerScrollerR=null;$hiddenParents=null;$footerRow=null;$footerRowL=null;$footerRowR=null;$footerRowSpacerL=null;$footerRowSpacerR=null;$footerRowScroller=null;$footerRowScrollerL=null;$footerRowScrollerR=null;$footerRowScrollContainer=null;$preHeaderPanel=null;$preHeaderPanelR=null;$preHeaderPanelScroller=null;$preHeaderPanelScrollerR=null;$preHeaderPanelSpacer=null;$preHeaderPanelSpacerR=null;$topPanel=null;$topPanelScroller=null;$style=null;$topPanelScrollerL=null;$topPanelScrollerR=null;$topPanelL=null;$topPanelR=null;$paneHeaderL=null;$paneHeaderR=null;$paneTopL=null;$paneTopR=null;$paneBottomL=null;$paneBottomR=null;$viewport=null;$viewportTopL=null;$viewportTopR=null;$viewportBottomL=null;$viewportBottomR=null;$viewportScrollContainerX=null;$viewportScrollContainerY=null}var canvas=null;var canvas_context=null;function autosizeColumn(e,o){var t=e;if(typeof e==="number"){t=columns[e]}else if(typeof e==="string"){for(var r=0;r<columns.length;r++){if(columns[r].Id===e){t=columns[r]}}}var n=$(getCanvasNode(0,0));getColAutosizeWidth(t,n,o)}function autosizeColumns(e,o){e=e||options.autosizeColsMode;if(e===Slick.GridAutosizeColsMode.LegacyForceFit||e===Slick.GridAutosizeColsMode.LegacyOff){legacyAutosizeColumns();return}if(e===Slick.GridAutosizeColsMode.None){return}canvas=document.createElement("canvas");if(canvas&&canvas.getContext){canvas_context=canvas.getContext("2d")}var t=$(getCanvasNode(0,0));var r=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;var n,i,l,a,s=0,d=0,c=0,u=0,f=0;for(n=0;n<columns.length;n++){i=columns[n];getColAutosizeWidth(i,t,o);f+=i.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked?i.width:0;u+=i.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked?i.width:i.minWidth;s+=i.autoSize.widthPx;d+=i.autoSize.sizeToRemaining?0:i.autoSize.widthPx;c+=i.autoSize.sizeToRemaining?i.minWidth||0:0}var h=s-d;if(e===Slick.GridAutosizeColsMode.FitViewportToCols){var p=s+scrollbarDimensions.width;e=Slick.GridAutosizeColsMode.IgnoreViewport;if(options.viewportMaxWidthPx&&p>options.viewportMaxWidthPx){p=options.viewportMaxWidthPx;e=Slick.GridAutosizeColsMode.FitColsToViewport}else if(options.viewportMinWidthPx&&p<options.viewportMinWidthPx){p=options.viewportMinWidthPx;e=Slick.GridAutosizeColsMode.FitColsToViewport}else{}$container.width(p)}if(e===Slick.GridAutosizeColsMode.FitColsToViewport){if(h>0&&d<r-c){for(n=0;n<columns.length;n++){i=columns[n];var v=r-d;if(i.autoSize.sizeToRemaining){l=v*i.autoSize.widthPx/h}else{l=i.autoSize.widthPx}if(i.rerenderOnResize&&i.width!=l){a=true}i.width=l}}else if(options.viewportSwitchToScrollModeWidthPercent&&d+c>r*options.viewportSwitchToScrollModeWidthPercent/100||u>r){e=Slick.GridAutosizeColsMode.IgnoreViewport}else{var g=d-f;var m=r-f-c;for(n=0;n<columns.length;n++){i=columns[n];l=i.width;if(i.autoSize.autosizeMode!==Slick.ColAutosizeMode.Locked){if(i.autoSize.sizeToRemaining){l=i.minWidth}else{l=m/g*i.autoSize.widthPx;if(l<i.minWidth){l=i.minWidth}g-=i.autoSize.widthPx;m-=l}}if(i.rerenderOnResize&&i.width!=l){a=true}i.width=l}}}if(e===Slick.GridAutosizeColsMode.IgnoreViewport){for(n=0;n<columns.length;n++){l=columns[n].autoSize.widthPx;if(columns[n].rerenderOnResize&&columns[n].width!=l){a=true}columns[n].width=l}}reRenderColumns(a)}function LogColWidths(){var e="Col Widths:";for(var o=0;o<columns.length;o++){e+=" "+columns[o].width}console.log(e)}function getColAutosizeWidth(e,o,t){var r=e.autoSize;r.widthPx=e.width;if(r.autosizeMode===Slick.ColAutosizeMode.Locked||r.autosizeMode===Slick.ColAutosizeMode.Guide){return}var n=getDataLength();if(r.autosizeMode===Slick.ColAutosizeMode.ContentIntelligent){var i=r.colDataTypeOf;var l;if(n>0){var a=getDataItem(0);if(a){l=a[e.field];i=typeof l;if(i==="object"){if(l instanceof Date){i="date"}if(typeof moment!=="undefined"&&l instanceof moment){i="moment"}}}}if(i==="boolean"){r.colValueArray=[true,false]}if(i==="number"){r.valueFilterMode=Slick.ValueFilterMode.GetGreatestAndSub;r.rowSelectionMode=Slick.RowSelectionMode.AllRows}if(i==="string"){r.valueFilterMode=Slick.ValueFilterMode.GetLongestText;r.rowSelectionMode=Slick.RowSelectionMode.AllRows;r.allowAddlPercent=5}if(i==="date"){r.colValueArray=[new Date(2009,8,30,12,20,20)]}if(i==="moment"&&typeof moment!=="undefined"){r.colValueArray=[moment([2009,8,30,12,20,20])]}}var s=getColContentSize(e,o,t);var d=r.allowAddlPercent?1+r.allowAddlPercent/100:1;s=s*d+options.autosizeColPaddingPx;if(e.minWidth&&s<e.minWidth){s=e.minWidth}if(e.maxWidth&&s>e.maxWidth){s=e.maxWidth}r.widthPx=s}function getColContentSize(e,o,t){var r=e.autoSize;var n=1;var i,l;var a=0;var s=0;if(!r.ignoreHeaderText){s=getColHeaderWidth(e)}if(s===0){s=e.width?e.width:e.maxWidth?e.maxWidth:e.minWidth?e.minWidth:20}if(r.colValueArray){a=getColWidth(e,o,r.colValueArray);return Math.max(s,a)}var d=getData();if(d.getItems){d=d.getItems()}if(d.length===0){return s}var c=(t?r.rowSelectionModeOnInit:undefined)||r.rowSelectionMode;if(c===Slick.RowSelectionMode.FirstRow){d=d.slice(0,1)}if(c===Slick.RowSelectionMode.LastRow){d=d.slice(d.length-1,d.length)}if(c===Slick.RowSelectionMode.FirstNRows){d=d.slice(0,r.rowSelectionCount)}if(r.valueFilterMode===Slick.ValueFilterMode.DeDuplicate){var u={};for(i=0,l=d.length;i<l;i++){u[d[i][e.field]]=true}if(Object.keys){d=Object.keys(u)}else{d=[];for(var i in u)d.push(i)}}if(r.valueFilterMode===Slick.ValueFilterMode.GetGreatestAndSub){var f,h=0,p=0;for(i=0,l=d.length;i<l;i++){f=d[i][e.field];if(Math.abs(f)>p){h=f;p=Math.abs(f)}}h=""+h;h=Array(h.length+1).join("9");h=+h;d=[h]}if(r.valueFilterMode===Slick.ValueFilterMode.GetLongestTextAndSub){var f,v=0;for(i=0,l=d.length;i<l;i++){f=d[i][e.field];if((f||"").length>v){v=f.length}}f=Array(v+1).join("m");n=options.autosizeTextAvgToMWidthRatio;d=[f]}if(r.valueFilterMode===Slick.ValueFilterMode.GetLongestText){var f="",v=0,g=0;for(i=0,l=d.length;i<l;i++){f=d[i][e.field];if((f||"").length>v){v=f.length;g=i}}f=d[g][e.field];d=[f]}a=getColWidth(e,o,d)*n;return Math.max(s,a)}function getColWidth(e,o,t){var r=getColumnIndex(e.id);var n=$('<div class="slick-row ui-widget-content"></div>');var i=$('<div class="slick-cell"></div>');i.css({position:"absolute",visibility:"hidden","text-overflow":"initial","white-space":"nowrap"});n.append(i);o.append(n);var l,a=0,s,d,c,u=0,f;if(canvas_context&&e.autoSize.widthEvalMode===Slick.WidthEvalMode.CanvasTextSize){canvas_context.font=i.css("font-size")+" "+i.css("font-family");$(t).each((function(o,t){f=Array.isArray(t)?t[e.field]:t;s=""+f;l=s?canvas_context.measureText(s).width:0;if(l>a){a=l;d=s}}));i.html(d);l=i.outerWidth();n.remove();i=null;return l}$(t).each((function(o,t){f=Array.isArray(t)?t[e.field]:t;if(e.formatterOverride){c=e.formatterOverride(o,r,f,e,t,self)}else if(e.formatter){c=e.formatter(o,r,f,e,t,self)}else{c=""+f}applyFormatResultToCellNode(c,i[0]);l=i.outerWidth();if(l>a){a=l}}));n.remove();i=null;return a}function getColHeaderWidth(e){var o=0;var t=getUID()+e.id;var r=document.getElementById(t);var n=t+"_";if(r){var i=r.cloneNode(true);i.id=n;i.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;";r.parentNode.insertBefore(i,r);o=i.offsetWidth;i.parentNode.removeChild(i)}else{var l=getHeader(e);r=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+e.name+"</span>").attr("id",n).css({position:"absolute",visibility:"hidden",right:"auto","text-overflow:":"initial","white-space":"nowrap"}).addClass(e.headerCssClass||"").appendTo(l);o=r[0].offsetWidth;l[0].removeChild(r[0])}return o}function legacyAutosizeColumns(){var e,o,t=[],r=0,n=0,i,l=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(e=0;e<columns.length;e++){o=columns[e];t.push(o.width);n+=o.width;if(o.resizable){r+=o.width-Math.max(o.minWidth,absoluteColumnMinWidth)}}i=n;while(n>l&&r){var a=(n-l)/r;for(e=0;e<columns.length&&n>l;e++){o=columns[e];var s=t[e];if(!o.resizable||s<=o.minWidth||s<=absoluteColumnMinWidth){continue}var d=Math.max(o.minWidth,absoluteColumnMinWidth);var c=Math.floor(a*(s-d))||1;c=Math.min(c,s-d);n-=c;r-=c;t[e]-=c}if(i<=n){break}i=n}i=n;while(n<l){var u=l/n;for(e=0;e<columns.length&&n<l;e++){o=columns[e];var f=t[e];var h;if(!o.resizable||o.maxWidth<=f){h=0}else{h=Math.min(Math.floor(u*f)-f,o.maxWidth-f||1e6)||1}n+=h;t[e]+=n<=l?h:0}if(i>=n){break}i=n}var p=false;for(e=0;e<columns.length;e++){if(columns[e].rerenderOnResize&&columns[e].width!=t[e]){p=true}columns[e].width=t[e]}reRenderColumns(p)}function reRenderColumns(e){applyColumnHeaderWidths();applyColumnGroupHeaderWidths();updateCanvasWidth(true);trigger(self.onAutosizeColumns,{columns});if(e){invalidateAllRows();render()}}function trigger(e,o,t){t=t||new Slick.EventData;o=o||{};o.grid=self;return e.notify(o,t,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(e){return columnsById[e]}function applyColumnGroupHeaderWidths(){if(!treeColumns.hasDepth())return;for(var e=$groupHeadersL.length-1;e>=0;e--){var o=treeColumns.getColumnsInDepth(e);$().add($groupHeadersL[e]).add($groupHeadersR[e]).each((function(e){var o=$(this),t=0;o.width(e===0?getHeadersWidthL():getHeadersWidthR());o.children().each((function(){var e=$(this);var r=$(this).data("column");r.width=0;r.columns.forEach((function(){var e=o.next().children(":eq("+t+++")");r.width+=e.outerWidth()}));e.width(r.width-headerColumnWidthDiff)}))}))}}function applyColumnHeaderWidths(){if(!initialized){return}var e;for(var o=0,t=$headers.children(),r=columns.length;o<r;o++){e=$(t[o]);if(jQueryNewWidthBehaviour){if(e.outerWidth()!==columns[o].width){e.outerWidth(columns[o].width)}}else{if(e.width()!==columns[o].width-headerColumnWidthDiff){e.width(columns[o].width-headerColumnWidthDiff)}}}updateColumnCaches()}function applyColumnWidths(){var e=0,o,t;for(var r=0;r<columns.length;r++){o=columns[r].width;t=getColumnCssRules(r);t.left.style.left=e+"px";t.right.style.right=(options.frozenColumn!=-1&&r>options.frozenColumn?canvasWidthR:canvasWidthL)-e-o+"px";if(options.frozenColumn==r){e=0}else{e+=columns[r].width}}}function setSortColumn(e,o){setSortColumns([{columnId:e,sortAsc:o}])}function setSortColumns(e){sortColumns=e;var o=options.numberedMultiColumnSort&&sortColumns.length>1;var t=$headers.children();t.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc");t.find(".slick-sort-indicator-numbered").text("");$.each(sortColumns,(function(e,r){if(r.sortAsc==null){r.sortAsc=true}var n=getColumnIndex(r.columnId);if(n!=null){t.eq(n).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(r.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc");if(o){t.eq(n).find(".slick-sort-indicator-numbered").text(e+1)}}}))}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,o){var t=selectedRows.slice(0);selectedRows=[];var r={};for(var n=0;n<o.length;n++){for(var i=o[n].fromRow;i<=o[n].toRow;i++){if(!r[i]){selectedRows.push(i);r[i]={}}for(var l=o[n].fromCell;l<=o[n].toCell;l++){if(canCellBeSelected(i,l)){r[i][columns[l].id]=options.selectedCellCssClass}}}}setCellCssStyles(options.selectedCellCssClass,r);if(simpleArrayEquals(t,selectedRows)){var a=e&&e.detail&&e.detail.caller||"click";var s=getSelectedRows().filter((function(e){return t.indexOf(e)<0}));var d=t.filter((function(e){return getSelectedRows().indexOf(e)<0}));trigger(self.onSelectedRowsChanged,{rows:getSelectedRows(),previousSelectedRows:t,caller:a,changedSelectedRows:s,changedUnselectedRows:d},e)}}function simpleArrayEquals(e,o){return Array.isArray(e)&&Array.isArray(o)&&o.sort().toString()!==e.sort().toString()}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[];columnPosRight=[];var e=0;for(var o=0,t=columns.length;o<t;o++){columnPosLeft[o]=e;columnPosRight[o]=e+columns[o].width;if(options.frozenColumn==o){e=0}else{e+=columns[o].width}}}function updateColumnProps(){columnsById={};for(var e=0;e<columns.length;e++){if(columns[e].width){columns[e].widthRequest=columns[e].width}var o=columns[e]=$.extend({},columnDefaults,columns[e]);o.autoSize=$.extend({},columnAutosizeDefaults,o.autoSize);columnsById[o.id]=e;if(o.minWidth&&o.width<o.minWidth){o.width=o.minWidth}if(o.maxWidth&&o.width>o.maxWidth){o.width=o.maxWidth}if(!o.resizable){}}}function setColumns(e){trigger(self.onBeforeSetColumns,{previousColumns:columns,newColumns:e,grid:self});var o=new Slick.TreeColumns(e);if(o.hasDepth()){treeColumns=o;columns=treeColumns.extractColumns()}else{columns=e}updateColumnProps();updateColumnCaches();if(initialized){setPaneVisibility();setOverflow();invalidateAllRows();createColumnHeaders();createColumnGroupHeaders();createColumnFooter();removeCssRules();createCssRules();resizeCanvas();updateCanvasWidth();applyColumnHeaderWidths();applyColumnWidths();handleScroll()}}function getOptions(){return options}function setOptions(e,o,t,r){if(!getEditorLock().commitCurrentEdit()){return}makeActiveCellNormal();if(e.showColumnHeader!==undefined){setColumnHeaderVisibility(e.showColumnHeader)}if(options.enableAddRow!==e.enableAddRow){invalidateRow(getDataLength())}var n=$.extend(true,{},options);options=$.extend(options,e);trigger(self.onSetOptions,{optionsBefore:n,optionsAfter:options});validateAndEnforceOptions();$viewport.css("overflow-y",options.autoHeight?"hidden":"auto");if(!o){render()}setFrozenOptions();setScroller();if(!r){setOverflow()}if(!t){setColumns(treeColumns.extractColumns())}if(options.enableMouseWheelScrollHandler&&$viewport&&jQuery.fn.mousewheel){var i=$._data($viewport[0],"events");if(!i||!i.mousewheel){$viewport.on("mousewheel",handleMouseWheel)}}else if(options.enableMouseWheelScrollHandler===false){$viewport.off("mousewheel")}}function validateAndEnforceOptions(){if(options.autoHeight){options.leaveSpaceForNewRows=false}if(options.forceFitColumns){options.autosizeColsMode=Slick.GridAutosizeColsMode.LegacyForceFit;console.log("forceFitColumns option is deprecated - use autosizeColsMode")}}function setData(e,o){data=e;invalidateAllRows();updateRowCount();if(o){scrollTo(0)}}function getData(){return data}function getDataLength(){if(data.getLength){return data.getLength()}else{return data&&data.length||0}}function getDataLengthIncludingAddNew(){return getDataLength()+(!options.enableAddRow?0:!pagingActive||pagingIsLastPage?1:0)}function getDataItem(e){if(data.getItem){return data.getItem(e)}else{return data[e]}}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(e,o){var t=o===false?false:true;if(options.showTopPanel!=e){options.showTopPanel=e;if(e){if(t){$topPanelScroller.slideDown("fast",resizeCanvas)}else{$topPanelScroller.show();resizeCanvas()}}else{if(t){$topPanelScroller.slideUp("fast",resizeCanvas)}else{$topPanelScroller.hide();resizeCanvas()}}}}function setHeaderRowVisibility(e,o){var t=o===false?false:true;if(options.showHeaderRow!=e){options.showHeaderRow=e;if(e){if(t){$headerRowScroller.slideDown("fast",resizeCanvas)}else{$headerRowScroller.show();resizeCanvas()}}else{if(t){$headerRowScroller.slideUp("fast",resizeCanvas)}else{$headerRowScroller.hide();resizeCanvas()}}}}function setColumnHeaderVisibility(e,o){if(options.showColumnHeader!=e){options.showColumnHeader=e;if(e){if(o){$headerScroller.slideDown("fast",resizeCanvas)}else{$headerScroller.show();resizeCanvas()}}else{if(o){$headerScroller.slideUp("fast",resizeCanvas)}else{$headerScroller.hide();resizeCanvas()}}}}function setFooterRowVisibility(e,o){var t=o===false?false:true;if(options.showFooterRow!=e){options.showFooterRow=e;if(e){if(t){$footerRowScroller.slideDown("fast",resizeCanvas)}else{$footerRowScroller.show();resizeCanvas()}}else{if(t){$footerRowScroller.slideUp("fast",resizeCanvas)}else{$footerRowScroller.hide();resizeCanvas()}}}}function setPreHeaderPanelVisibility(e,o){var t=o===false?false:true;if(options.showPreHeaderPanel!=e){options.showPreHeaderPanel=e;if(e){if(t){$preHeaderPanelScroller.slideDown("fast",resizeCanvas);$preHeaderPanelScrollerR.slideDown("fast",resizeCanvas)}else{$preHeaderPanelScroller.show();$preHeaderPanelScrollerR.show();resizeCanvas()}}else{if(t){$preHeaderPanelScroller.slideUp("fast",resizeCanvas);$preHeaderPanelScrollerR.slideUp("fast",resizeCanvas)}else{$preHeaderPanelScroller.hide();$preHeaderPanelScrollerR.hide();resizeCanvas()}}}}function getContainerNode(){return $container.get(0)}function getRowTop(e){return options.rowHeight*e-offset}function getRowFromPosition(e){return Math.floor((e+offset)/options.rowHeight)}function scrollTo(e){e=Math.max(e,0);e=Math.min(e,th-$viewportScrollContainerY.height()+(viewportHasHScroll||hasFrozenColumns()?scrollbarDimensions.height:0));var o=offset;page=Math.min(n-1,Math.floor(e/ph));offset=Math.round(page*cj);var t=e-offset;if(offset!=o){var r=getVisibleRange(t);cleanupRows(r);updateRowPositions()}if(prevScrollTop!=t){vScrollDir=prevScrollTop+o<t+offset?1:-1;lastRenderedScrollTop=scrollTop=prevScrollTop=t;if(hasFrozenColumns()){$viewportTopL[0].scrollTop=t}if(hasFrozenRows){$viewportBottomL[0].scrollTop=$viewportBottomR[0].scrollTop=t}$viewportScrollContainerY[0].scrollTop=t;trigger(self.onViewportChanged,{})}}function defaultFormatter(e,o,t,r,n,i){if(t==null){return""}else{return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}function getFormatter(e,o){var t=data.getItemMetadata&&data.getItemMetadata(e);var r=t&&t.columns&&(t.columns[o.id]||t.columns[getColumnIndex(o.id)]);return r&&r.formatter||t&&t.formatter||o.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(o)||options.defaultFormatter}function getEditor(e,o){var t=columns[o];var r=data.getItemMetadata&&data.getItemMetadata(e);var n=r&&r.columns;if(n&&n[t.id]&&n[t.id].editor!==undefined){return n[t.id].editor}if(n&&n[o]&&n[o].editor!==undefined){return n[o].editor}return t.editor||options.editorFactory&&options.editorFactory.getEditor(t)}function getDataItemValueForColumn(e,o){if(options.dataItemColumnValueExtractor){return options.dataItemColumnValueExtractor(e,o)}return e[o.field]}function appendRowHtml(e,o,t,r,n){var i=getDataItem(t);var l=t<n&&!i;var a="slick-row"+(hasFrozenRows&&t<=options.frozenRow?" frozen":"")+(l?" loading":"")+(t===activeRow&&options.showCellSelection?" active":"")+(t%2==1?" odd":" even");if(!i){a+=" "+options.addNewRowCssClass}var s=data.getItemMetadata&&data.getItemMetadata(t);if(s&&s.cssClasses){a+=" "+s.cssClasses}var d=getFrozenRowOffset(t);var c="<div class='ui-widget-content "+a+"' style='top:"+(getRowTop(t)-d)+"px'>";e.push(c);if(hasFrozenColumns()){o.push(c)}var u,f;for(var h=0,p=columns.length;h<p;h++){f=columns[h];u=1;if(s&&s.columns){var v=s.columns[f.id]||s.columns[h];u=v&&v.colspan||1;if(u==="*"){u=p-h}}if(columnPosRight[Math.min(p-1,h+u-1)]>r.leftPx){if(!f.alwaysRenderColumn&&columnPosLeft[h]>r.rightPx){break}if(hasFrozenColumns()&&h>options.frozenColumn){appendCellHtml(o,t,h,u,i)}else{appendCellHtml(e,t,h,u,i)}}else if(f.alwaysRenderColumn||hasFrozenColumns()&&h<=options.frozenColumn){appendCellHtml(e,t,h,u,i)}if(u>1){h+=u-1}}e.push("</div>");if(hasFrozenColumns()){o.push("</div>")}}function appendCellHtml(e,o,t,r,n){var i=columns[t];var l="slick-cell l"+t+" r"+Math.min(columns.length-1,t+r-1)+(i.cssClass?" "+i.cssClass:"");if(hasFrozenColumns()&&t<=options.frozenColumn){l+=" frozen"}if(o===activeRow&&t===activeCell&&options.showCellSelection){l+=" active"}for(var a in cellCssClasses){if(cellCssClasses[a][o]&&cellCssClasses[a][o][i.id]){l+=" "+cellCssClasses[a][o][i.id]}}var s=null,d="";if(n){s=getDataItemValueForColumn(n,i);d=getFormatter(o,i)(o,t,s,i,n,self);if(d===null||d===undefined){d=""}}var c=trigger(self.onBeforeAppendCell,{row:o,cell:t,value:s,dataContext:n})||"";c+=d&&d.addClasses?(c?" ":"")+d.addClasses:"";var u=d&&d.toolTip?"title='"+d.toolTip+"'":"";var f="";if(i.hasOwnProperty("cellAttrs")&&i.cellAttrs instanceof Object){for(var a in i.cellAttrs){if(i.cellAttrs.hasOwnProperty(a)){f+=" "+a+'="'+i.cellAttrs[a]+'" '}}}e.push("<div class='"+l+(c?" "+c:"")+"' "+u+f+">");if(n){e.push(Object.prototype.toString.call(d)!=="[object Object]"?d:d.text)}e.push("</div>");rowsCache[o].cellRenderQueue.push(t);rowsCache[o].cellColSpans[t]=r}function cleanupRows(e){for(var o in rowsCache){var t=true;if(hasFrozenRows&&(options.frozenBottom&&o>=actualFrozenRow||!options.frozenBottom&&o<=actualFrozenRow)){t=false}if((o=parseInt(o,10))!==activeRow&&(o<e.top||o>e.bottom)&&t){removeRowFromCache(o)}}if(options.enableAsyncPostRenderCleanup){startPostProcessingCleanup()}}function invalidate(){updateRowCount();invalidateAllRows();render()}function invalidateAllRows(){if(currentEditor){makeActiveCellNormal()}for(var e in rowsCache){removeRowFromCache(e)}if(options.enableAsyncPostRenderCleanup){startPostProcessingCleanup()}}function queuePostProcessedRowForCleanup(e,o,t){postProcessgroupId++;for(var r in o){if(o.hasOwnProperty(r)){postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:e.cellNodesByColumnIdx[r|0],columnIdx:r|0,rowIdx:t})}}postProcessedCleanupQueue.push({actionType:"R",groupId:postProcessgroupId,node:e.rowNode});e.rowNode.detach()}function queuePostProcessedCellForCleanup(e,o,t){postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:e,columnIdx:o,rowIdx:t});$(e).detach()}function removeRowFromCache(e){var o=rowsCache[e];if(!o){return}if(options.enableAsyncPostRenderCleanup&&postProcessedRows[e]){queuePostProcessedRowForCleanup(o,postProcessedRows[e],e)}else{o.rowNode.each((function(){if(this.parentElement){this.parentElement.removeChild(this)}}))}delete rowsCache[e];delete postProcessedRows[e];renderedRows--;counter_rows_removed++}function invalidateRows(e){var o,t;if(!e||!e.length){return}vScrollDir=0;t=e.length;for(o=0;o<t;o++){if(currentEditor&&activeRow===e[o]){makeActiveCellNormal()}if(rowsCache[e[o]]){removeRowFromCache(e[o])}}if(options.enableAsyncPostRenderCleanup){startPostProcessingCleanup()}}function invalidateRow(e){if(!e&&e!==0){return}invalidateRows([e])}function applyFormatResultToCellNode(e,o,t){if(e===null||e===undefined){e=""}if(Object.prototype.toString.call(e)!=="[object Object]"){o.innerHTML=sanitizeHtmlString(e);return}o.innerHTML=sanitizeHtmlString(e.text);if(e.removeClasses&&!t){$(o).removeClass(e.removeClasses)}if(e.addClasses){$(o).addClass(e.addClasses)}if(e.toolTip){$(o).attr("title",e.toolTip)}}function updateCell(e,o){var t=getCellNode(e,o);if(!t){return}var r=columns[o],n=getDataItem(e);if(currentEditor&&activeRow===e&&activeCell===o){currentEditor.loadValue(n)}else{var i=n?getFormatter(e,r)(e,o,getDataItemValueForColumn(n,r),r,n,self):"";applyFormatResultToCellNode(i,t);invalidatePostProcessingResults(e)}}function updateRow(e){var o=rowsCache[e];if(!o){return}ensureCellNodesInRowsCache(e);var t,r=getDataItem(e);for(var n in o.cellNodesByColumnIdx){if(!o.cellNodesByColumnIdx.hasOwnProperty(n)){continue}n=n|0;var i=columns[n],l=o.cellNodesByColumnIdx[n][0];if(e===activeRow&&n===activeCell&&currentEditor){currentEditor.loadValue(r)}else if(r){t=getFormatter(e,i)(e,n,getDataItemValueForColumn(r,i),i,r,self);applyFormatResultToCellNode(t,l)}else{l.innerHTML=""}}invalidatePostProcessingResults(e)}function getViewportHeight(){if(!options.autoHeight||options.frozenColumn!=-1){topPanelH=options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0;headerRowH=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0;footerRowH=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0}if(options.autoHeight){var e=$paneHeaderL.outerHeight();e+=options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0;e+=options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0;e+=getCanvasWidth()>viewportW?scrollbarDimensions.height:0;viewportH=options.rowHeight*getDataLengthIncludingAddNew()+(options.frozenColumn==-1?e:0)}else{var o=options.showColumnHeader?parseFloat($.css($headerScroller[0],"height"))+getVBoxDelta($headerScroller):0;var t=options.createPreHeaderPanel&&options.showPreHeaderPanel?options.preHeaderPanelHeight+getVBoxDelta($preHeaderPanelScroller):0;viewportH=parseFloat($.css($container[0],"height",true))-parseFloat($.css($container[0],"paddingTop",true))-parseFloat($.css($container[0],"paddingBottom",true))-o-topPanelH-headerRowH-footerRowH-t}numVisibleRows=Math.ceil(viewportH/options.rowHeight);return viewportH}function getViewportWidth(){viewportW=parseFloat($container.width())}function resizeCanvas(){if(!initialized){return}paneTopH=0;paneBottomH=0;viewportTopH=0;viewportBottomH=0;getViewportWidth();getViewportHeight();if(hasFrozenRows){if(options.frozenBottom){paneTopH=viewportH-frozenRowsHeight-scrollbarDimensions.height;paneBottomH=frozenRowsHeight+scrollbarDimensions.height}else{paneTopH=frozenRowsHeight;paneBottomH=viewportH-frozenRowsHeight}}else{paneTopH=viewportH}paneTopH+=topPanelH+headerRowH+footerRowH;if(hasFrozenColumns()&&options.autoHeight){paneTopH+=scrollbarDimensions.height}viewportTopH=paneTopH-topPanelH-headerRowH-footerRowH;if(options.autoHeight){if(hasFrozenColumns()){$container.height(paneTopH+parseFloat($.css($headerScrollerL[0],"height")))}$paneTopL.css("position","relative")}$paneTopL.css({top:$paneHeaderL.height()||(options.showHeaderRow?options.headerRowHeight:0)+(options.showPreHeaderPanel?options.preHeaderPanelHeight:0),height:paneTopH});var e=$paneTopL.position().top+paneTopH;if(!options.autoHeight){$viewportTopL.height(viewportTopH)}if(hasFrozenColumns()){$paneTopR.css({top:$paneHeaderL.height(),height:paneTopH});$viewportTopR.height(viewportTopH);if(hasFrozenRows){$paneBottomL.css({top:e,height:paneBottomH});$paneBottomR.css({top:e,height:paneBottomH});$viewportBottomR.height(paneBottomH)}}else{if(hasFrozenRows){$paneBottomL.css({width:"100%",height:paneBottomH});$paneBottomL.css("top",e)}}if(hasFrozenRows){$viewportBottomL.height(paneBottomH);if(options.frozenBottom){$canvasBottomL.height(frozenRowsHeight);if(hasFrozenColumns()){$canvasBottomR.height(frozenRowsHeight)}}else{$canvasTopL.height(frozenRowsHeight);if(hasFrozenColumns()){$canvasTopR.height(frozenRowsHeight)}}}else{$viewportTopR.height(viewportTopH)}if(!scrollbarDimensions||!scrollbarDimensions.width){scrollbarDimensions=measureScrollbar()}if(options.autosizeColsMode===Slick.GridAutosizeColsMode.LegacyForceFit){autosizeColumns()}updateRowCount();handleScroll();lastRenderedScrollLeft=-1;render()}function updatePagingStatusFromView(e){pagingActive=e.pageSize!==0;pagingIsLastPage=e.pageNum==e.totalPages-1}function updateRowCount(){if(!initialized){return}var e=getDataLength();var o=getDataLengthIncludingAddNew();var t=0;var r=hasFrozenRows&&!options.frozenBottom?$canvasBottomL.height():$canvasTopL.height();if(hasFrozenRows){var t=getDataLength()-options.frozenRow}else{var t=o+(options.leaveSpaceForNewRows?numVisibleRows-1:0)}var i=$viewportScrollContainerY.height();var l=viewportHasVScroll;viewportHasVScroll=options.alwaysShowVerticalScroll||!options.autoHeight&&t*options.rowHeight>i;makeActiveCellNormal();var a=e-1;for(var s in rowsCache){if(s>a){removeRowFromCache(s)}}if(options.enableAsyncPostRenderCleanup){startPostProcessingCleanup()}if(activeCellNode&&activeRow>a){resetActiveCell()}var r=h;if(options.autoHeight){h=options.rowHeight*t}else{th=Math.max(options.rowHeight*t,i-scrollbarDimensions.height);if(th<maxSupportedCssHeight){h=ph=th;n=1;cj=0}else{h=maxSupportedCssHeight;ph=h/100;n=Math.floor(th/ph);cj=(th-h)/(n-1)}}if(h!==r){if(hasFrozenRows&&!options.frozenBottom){$canvasBottomL.css("height",h);if(hasFrozenColumns()){$canvasBottomR.css("height",h)}}else{$canvasTopL.css("height",h);$canvasTopR.css("height",h)}scrollTop=$viewportScrollContainerY[0].scrollTop}var d=scrollTop+offset<=th-i;if(th==0||scrollTop==0){page=offset=0}else if(d){scrollTo(scrollTop+offset)}else{scrollTo(th-i)}if(h!=r&&options.autoHeight){resizeCanvas()}if(options.autosizeColsMode===Slick.GridAutosizeColsMode.LegacyForceFit&&l!=viewportHasVScroll){autosizeColumns()}updateCanvasWidth(false)}function getVisibleRange(e,o){if(e==null){e=scrollTop}if(o==null){o=scrollLeft}return{top:getRowFromPosition(e),bottom:getRowFromPosition(e+viewportH)+1,leftPx:o,rightPx:o+viewportW}}function getRenderedRange(e,o){var t=getVisibleRange(e,o);var r=Math.round(viewportH/options.rowHeight);var n=options.minRowBuffer;if(vScrollDir==-1){t.top-=r;t.bottom+=n}else if(vScrollDir==1){t.top-=n;t.bottom+=r}else{t.top-=n;t.bottom+=n}t.top=Math.max(0,t.top);t.bottom=Math.min(getDataLengthIncludingAddNew()-1,t.bottom);t.leftPx-=viewportW;t.rightPx+=viewportW;t.leftPx=Math.max(0,t.leftPx);t.rightPx=Math.min(canvasWidth,t.rightPx);return t}function ensureCellNodesInRowsCache(e){var o=rowsCache[e];if(o){if(o.cellRenderQueue.length){var t=o.rowNode.children().last();while(o.cellRenderQueue.length){var r=o.cellRenderQueue.pop();o.cellNodesByColumnIdx[r]=t;t=t.prev();if(t.length===0){t=$(o.rowNode[0]).children().last()}}}}}function cleanUpCells(e,o){if(hasFrozenRows&&(options.frozenBottom&&o>actualFrozenRow||o<=actualFrozenRow)){return}var t=0;var r=rowsCache[o];var n=[];for(var i in r.cellNodesByColumnIdx){if(!r.cellNodesByColumnIdx.hasOwnProperty(i)){continue}i=i|0;if(i<=options.frozenColumn){continue}if(Array.isArray(columns)&&columns[i]&&columns[i].alwaysRenderColumn){continue}var l=r.cellColSpans[i];if(columnPosLeft[i]>e.rightPx||columnPosRight[Math.min(columns.length-1,i+l-1)]<e.leftPx){if(!(o==activeRow&&i==activeCell)){n.push(i)}}}var a,s;while((a=n.pop())!=null){s=r.cellNodesByColumnIdx[a][0];if(options.enableAsyncPostRenderCleanup&&postProcessedRows[o]&&postProcessedRows[o][a]){queuePostProcessedCellForCleanup(s,a,o)}else{s.parentElement.removeChild(s)}delete r.cellColSpans[a];delete r.cellNodesByColumnIdx[a];if(postProcessedRows[o]){delete postProcessedRows[o][a]}t++}}function cleanUpAndRenderCells(e){var o;var t=[];var r=[];var n;var i=0;var l;for(var a=e.top,s=e.bottom;a<=s;a++){o=rowsCache[a];if(!o){continue}ensureCellNodesInRowsCache(a);cleanUpCells(e,a);n=0;var d=data.getItemMetadata&&data.getItemMetadata(a);d=d&&d.columns;var c=getDataItem(a);for(var u=0,f=columns.length;u<f;u++){if(columnPosLeft[u]>e.rightPx){break}if((l=o.cellColSpans[u])!=null){u+=l>1?l-1:0;continue}l=1;if(d){var h=d[columns[u].id]||d[u];l=h&&h.colspan||1;if(l==="*"){l=f-u}}if(columnPosRight[Math.min(f-1,u+l-1)]>e.leftPx){appendCellHtml(t,a,u,l,c);n++}u+=l>1?l-1:0}if(n){i+=n;r.push(a)}}if(!t.length){return}var p=document.createElement("div");p.innerHTML=sanitizeHtmlString(t.join(""));var v;var g;while((v=r.pop())!=null){o=rowsCache[v];var m;while((m=o.cellRenderQueue.pop())!=null){g=p.lastChild;if(hasFrozenColumns()&&m>options.frozenColumn){o.rowNode[1].appendChild(g)}else{o.rowNode[0].appendChild(g)}o.cellNodesByColumnIdx[m]=$(g)}}}function renderRows(e){var o=[],t=[],r=[],n=false,i=getDataLength();for(var l=e.top,a=e.bottom;l<=a;l++){if(rowsCache[l]||hasFrozenRows&&options.frozenBottom&&l==getDataLength()){continue}renderedRows++;r.push(l);rowsCache[l]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]};appendRowHtml(o,t,l,e,i);if(activeCellNode&&activeRow===l){n=true}counter_rows_rendered++}if(!r.length){return}var s=document.createElement("div"),d=document.createElement("div");s.innerHTML=sanitizeHtmlString(o.join(""));d.innerHTML=sanitizeHtmlString(t.join(""));for(var l=0,a=r.length;l<a;l++){if(hasFrozenRows&&r[l]>=actualFrozenRow){if(hasFrozenColumns()){rowsCache[r[l]].rowNode=$().add($(s.firstChild)).add($(d.firstChild));$canvasBottomL[0].appendChild(s.firstChild);$canvasBottomR[0].appendChild(d.firstChild)}else{rowsCache[r[l]].rowNode=$().add($(s.firstChild));$canvasBottomL[0].appendChild(s.firstChild)}}else if(hasFrozenColumns()){rowsCache[r[l]].rowNode=$().add($(s.firstChild)).add($(d.firstChild));$canvasTopL[0].appendChild(s.firstChild);$canvasTopR[0].appendChild(d.firstChild)}else{rowsCache[r[l]].rowNode=$().add($(s.firstChild));$canvasTopL[0].appendChild(s.firstChild)}}if(n){activeCellNode=getCellNode(activeRow,activeCell)}}function startPostProcessing(){if(!options.enableAsyncPostRender){return}clearTimeout(h_postrender);h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay)}function startPostProcessingCleanup(){if(!options.enableAsyncPostRenderCleanup){return}clearTimeout(h_postrenderCleanup);h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}function invalidatePostProcessingResults(e){for(var o in postProcessedRows[e]){if(postProcessedRows[e].hasOwnProperty(o)){postProcessedRows[e][o]="C"}}postProcessFromRow=Math.min(postProcessFromRow,e);postProcessToRow=Math.max(postProcessToRow,e);startPostProcessing()}function updateRowPositions(){for(var e in rowsCache){var o=e?parseInt(e):0;rowsCache[o].rowNode[0].style.top=getRowTop(o)+"px"}}function render(){if(!initialized){return}scrollThrottle.dequeue();var e=getVisibleRange();var o=getRenderedRange();cleanupRows(o);if(lastRenderedScrollLeft!=scrollLeft){if(hasFrozenRows){var t=jQuery.extend(true,{},o);if(options.frozenBottom){t.top=actualFrozenRow;t.bottom=getDataLength()}else{t.top=0;t.bottom=options.frozenRow}cleanUpAndRenderCells(t)}cleanUpAndRenderCells(o)}renderRows(o);if(hasFrozenRows){if(options.frozenBottom){renderRows({top:actualFrozenRow,bottom:getDataLength()-1,leftPx:o.leftPx,rightPx:o.rightPx})}else{renderRows({top:0,bottom:options.frozenRow-1,leftPx:o.leftPx,rightPx:o.rightPx})}}postProcessFromRow=e.top;postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,e.bottom);startPostProcessing();lastRenderedScrollTop=scrollTop;lastRenderedScrollLeft=scrollLeft;h_render=null;trigger(self.onRendered,{startRow:e.top,endRow:e.bottom,grid:self})}function handleHeaderScroll(){handleElementScroll($headerScrollContainer[0])}function handleHeaderRowScroll(){var e=$headerRowScrollContainer[0].scrollLeft;if(e!=$viewportScrollContainerX[0].scrollLeft){$viewportScrollContainerX[0].scrollLeft=e}}function handleFooterRowScroll(){var e=$footerRowScrollContainer[0].scrollLeft;if(e!=$viewportScrollContainerX[0].scrollLeft){$viewportScrollContainerX[0].scrollLeft=e}}function handlePreHeaderPanelScroll(){handleElementScroll($preHeaderPanelScroller[0])}function handleElementScroll(e){var o=e.scrollLeft;if(o!=$viewportScrollContainerX[0].scrollLeft){$viewportScrollContainerX[0].scrollLeft=o}}function handleScroll(){scrollTop=$viewportScrollContainerY[0].scrollTop;scrollLeft=$viewportScrollContainerX[0].scrollLeft;return _handleScroll(false)}function _handleScroll(e){var o=$viewportScrollContainerY[0].scrollHeight-$viewportScrollContainerY[0].clientHeight;var t=$viewportScrollContainerY[0].scrollWidth-$viewportScrollContainerY[0].clientWidth;o=Math.max(0,o);t=Math.max(0,t);if(scrollTop>o){scrollTop=o}if(scrollLeft>t){scrollLeft=t}var r=Math.abs(scrollTop-prevScrollTop);var i=Math.abs(scrollLeft-prevScrollLeft);if(i){prevScrollLeft=scrollLeft;$viewportScrollContainerX[0].scrollLeft=scrollLeft;$headerScrollContainer[0].scrollLeft=scrollLeft;$topPanelScroller[0].scrollLeft=scrollLeft;$headerRowScrollContainer[0].scrollLeft=scrollLeft;if(options.createFooterRow){$footerRowScrollContainer[0].scrollLeft=scrollLeft}if(options.createPreHeaderPanel){if(hasFrozenColumns()){$preHeaderPanelScrollerR[0].scrollLeft=scrollLeft}else{$preHeaderPanelScroller[0].scrollLeft=scrollLeft}}if(hasFrozenColumns()){if(hasFrozenRows){$viewportTopR[0].scrollLeft=scrollLeft}}else{if(hasFrozenRows){$viewportTopL[0].scrollLeft=scrollLeft}}}if(r){vScrollDir=prevScrollTop<scrollTop?1:-1;prevScrollTop=scrollTop;if(e){$viewportScrollContainerY[0].scrollTop=scrollTop}if(hasFrozenColumns()){if(hasFrozenRows&&!options.frozenBottom){$viewportBottomL[0].scrollTop=scrollTop}else{$viewportTopL[0].scrollTop=scrollTop}}if(r<viewportH){scrollTo(scrollTop+offset)}else{var l=offset;if(h==viewportH){page=0}else{page=Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph)))}offset=Math.round(page*cj);if(l!=offset){invalidateAllRows()}}}if(i||r){var a=Math.abs(lastRenderedScrollLeft-scrollLeft);var s=Math.abs(lastRenderedScrollTop-scrollTop);if(a>20||s>20){if(options.forceSyncScrolling||s<viewportH&&a<viewportW){render()}else{scrollThrottle.enqueue()}trigger(self.onViewportChanged,{})}}trigger(self.onScroll,{scrollLeft,scrollTop});if(i||r)return true;return false}function ActionThrottle(e,o){var t=false;var r=false;function n(){if(!t){l()}else{r=true}}function i(){r=false}function l(){t=true;setTimeout(a,o);e()}function a(){if(r){i();l()}else{t=false}}return{enqueue:n,dequeue:i}}function asyncPostProcessRows(){var e=getDataLength();while(postProcessFromRow<=postProcessToRow){var o=vScrollDir>=0?postProcessFromRow++:postProcessToRow--;var t=rowsCache[o];if(!t||o>=e){continue}if(!postProcessedRows[o]){postProcessedRows[o]={}}ensureCellNodesInRowsCache(o);for(var r in t.cellNodesByColumnIdx){if(!t.cellNodesByColumnIdx.hasOwnProperty(r)){continue}r=r|0;var n=columns[r];var i=postProcessedRows[o][r];if(n.asyncPostRender&&i!=="R"){var l=t.cellNodesByColumnIdx[r];if(l){n.asyncPostRender(l,o,getDataItem(o),n,i==="C")}postProcessedRows[o][r]="R"}}h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay);return}}function asyncPostProcessCleanupRows(){if(postProcessedCleanupQueue.length>0){var e=postProcessedCleanupQueue[0].groupId;while(postProcessedCleanupQueue.length>0&&postProcessedCleanupQueue[0].groupId==e){var o=postProcessedCleanupQueue.shift();if(o.actionType=="R"){$(o.node).remove()}if(o.actionType=="C"){var t=columns[o.columnIdx];if(t.asyncPostRenderCleanup&&o.node){t.asyncPostRenderCleanup(o.node,o.rowIdx,t)}}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(e,o){var t,r,n,i;for(var l in rowsCache){i=o&&o[l];n=e&&e[l];if(i){for(r in i){if(!n||i[r]!=n[r]){t=getCellNode(l,getColumnIndex(r));if(t){$(t).removeClass(i[r])}}}}if(n){for(r in n){if(!i||i[r]!=n[r]){t=getCellNode(l,getColumnIndex(r));if(t){$(t).addClass(n[r])}}}}}}function addCellCssStyles(e,o){if(cellCssClasses[e]){throw new Error("SlickGrid addCellCssStyles: cell CSS hash with key '"+e+"' already exists.")}cellCssClasses[e]=o;updateCellCssStylesOnRenderedRows(o,null);trigger(self.onCellCssStylesChanged,{key:e,hash:o,grid:self})}function removeCellCssStyles(e){if(!cellCssClasses[e]){return}updateCellCssStylesOnRenderedRows(null,cellCssClasses[e]);delete cellCssClasses[e];trigger(self.onCellCssStylesChanged,{key:e,hash:null,grid:self})}function setCellCssStyles(e,o){var t=cellCssClasses[e];cellCssClasses[e]=o;updateCellCssStylesOnRenderedRows(o,t);trigger(self.onCellCssStylesChanged,{key:e,hash:o,grid:self})}function getCellCssStyles(e){return cellCssClasses[e]}function flashCell(e,o,t){t=t||100;function r(e,o){if(!o){return}setTimeout((function(){e.queue((function(){e.toggleClass(options.cellFlashingCssClass).dequeue();r(e,o-1)}))}),t)}if(rowsCache[e]){var n=$(getCellNode(e,o));r(n,4)}}function handleMouseWheel(e,o,t,r){scrollTop=Math.max(0,$viewportScrollContainerY[0].scrollTop-r*options.rowHeight);scrollLeft=$viewportScrollContainerX[0].scrollLeft+t*10;var n=_handleScroll(true);if(n)e.preventDefault()}function handleDragInit(e,o){var t=getCellFromEvent(e);if(!t||!cellExists(t.row,t.cell)){return false}var r=trigger(self.onDragInit,o,e);if(e.isImmediatePropagationStopped()){return r}return false}function handleDragStart(e,o){var t=getCellFromEvent(e);if(!t||!cellExists(t.row,t.cell)){return false}var r=trigger(self.onDragStart,o,e);if(e.isImmediatePropagationStopped()){return r}return false}function handleDrag(e,o){return trigger(self.onDrag,o,e)}function handleDragEnd(e,o){trigger(self.onDragEnd,o,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},e);var o=e.isImmediatePropagationStopped();var t=Slick.keyCode;if(!o){if(!e.shiftKey&&!e.altKey){if(options.editable&&currentEditor&&currentEditor.keyCaptureList){if(currentEditor.keyCaptureList.indexOf(e.which)>-1){return}}if(e.which==t.HOME){o=e.ctrlKey?navigateTop():navigateRowStart()}else if(e.which==t.END){o=e.ctrlKey?navigateBottom():navigateRowEnd()}}}if(!o){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey){if(options.editable&&currentEditor&&currentEditor.keyCaptureList){if(currentEditor.keyCaptureList.indexOf(e.which)>-1){return}}if(e.which==t.ESCAPE){if(!getEditorLock().isActive()){return}cancelEditAndSetFocus()}else if(e.which==t.PAGE_DOWN){navigatePageDown();o=true}else if(e.which==t.PAGE_UP){navigatePageUp();o=true}else if(e.which==t.LEFT){o=navigateLeft()}else if(e.which==t.RIGHT){o=navigateRight()}else if(e.which==t.UP){o=navigateUp()}else if(e.which==t.DOWN){o=navigateDown()}else if(e.which==t.TAB){o=navigateNext()}else if(e.which==t.ENTER){if(options.editable){if(currentEditor){if(activeRow===getDataLength()){navigateDown()}else{commitEditAndSetFocus()}}else{if(getEditorLock().commitCurrentEdit()){makeActiveCellEditable(undefined,undefined,e)}}}o=true}}else if(e.which==t.TAB&&e.shiftKey&&!e.ctrlKey&&!e.altKey){o=navigatePrev()}}if(o){e.stopPropagation();e.preventDefault();try{e.originalEvent.keyCode=0}catch(r){}}}function handleClick(e){if(!currentEditor){if(e.target!=document.activeElement||$(e.target).hasClass("slick-cell")){var o=getTextSelection();setFocus();setTextSelection(o)}}var t=getCellFromEvent(e);if(!t||currentEditor!==null&&activeRow==t.row&&activeCell==t.cell){return}trigger(self.onClick,{row:t.row,cell:t.cell},e);if(e.isImmediatePropagationStopped()){return}if(canCellBeActive(t.row,t.cell)){if(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()){scrollRowIntoView(t.row,false);var r=e.target&&e.target.className===Slick.preClickClassName;var n=columns[t.cell];var i=!!(options.editable&&n&&n.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(getCellNode(t.row,t.cell),null,r,i,e)}}}function handleContextMenu(e){var o=$(e.target).closest(".slick-cell",$canvas);if(o.length===0){return}if(activeCellNode===o[0]&&currentEditor!==null){return}trigger(self.onContextMenu,{},e)}function handleDblClick(e){var o=getCellFromEvent(e);if(!o||currentEditor!==null&&activeRow==o.row&&activeCell==o.cell){return}trigger(self.onDblClick,{row:o.row,cell:o.cell},e);if(e.isImmediatePropagationStopped()){return}if(options.editable){gotoCell(o.row,o.cell,true,e)}}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:$(this).data("column"),grid:self},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:$(this).data("column"),grid:self},e)}function handleHeaderRowMouseEnter(e){trigger(self.onHeaderRowMouseEnter,{column:$(this).data("column"),grid:self},e)}function handleHeaderRowMouseLeave(e){trigger(self.onHeaderRowMouseLeave,{column:$(this).data("column"),grid:self},e)}function handleHeaderContextMenu(e){var o=$(e.target).closest(".slick-header-column",".slick-header-columns");var t=o&&o.data("column");trigger(self.onHeaderContextMenu,{column:t},e)}function handleHeaderClick(e){if(columnResizeDragging)return;var o=$(e.target).closest(".slick-header-column",".slick-header-columns");var t=o&&o.data("column");if(t){trigger(self.onHeaderClick,{column:t},e)}}function handleFooterContextMenu(e){var o=$(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns");var t=o&&o.data("column");trigger(self.onFooterContextMenu,{column:t},e)}function handleFooterClick(e){var o=$(e.target).closest(".slick-footerrow-column",".slick-footerrow-columns");var t=o&&o.data("column");trigger(self.onFooterClick,{column:t},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(e,o){return!(e<0||e>=getDataLength()||o<0||o>=columns.length)}function getCellFromPoint(e,o){var t=getRowFromPosition(o);var r=0;var n=0;for(var i=0;i<columns.length&&n<e;i++){n+=columns[i].width;r++}if(r<0){r=0}return{row:t,cell:r-1}}function getCellFromNode(e){var o=/l\d+/.exec(e.className);if(!o){throw new Error("SlickGrid getCellFromNode: cannot get cell - "+e.className)}return parseInt(o[0].substr(1,o[0].length-1),10)}function getRowFromNode(e){for(var o in rowsCache){for(var t in rowsCache[o].rowNode){if(rowsCache[o].rowNode[t]===e)return o?parseInt(o):0}}return null}function getFrozenRowOffset(e){var o=hasFrozenRows?options.frozenBottom?e>=actualFrozenRow?h<viewportTopH?actualFrozenRow*options.rowHeight:h:0:e>=actualFrozenRow?frozenRowsHeight:0:0;return o}function getCellFromEvent(e){var o,t;var r=$(e.target).closest(".slick-cell",$canvas);if(!r.length){return null}o=getRowFromNode(r[0].parentNode);if(hasFrozenRows){var n=r.parents(".grid-canvas").offset();var i=0;var l=r.parents(".grid-canvas-bottom").length;if(l){i=options.frozenBottom?$canvasTopL.height():frozenRowsHeight}o=getCellFromPoint(e.clientX-n.left,e.clientY-n.top+i+$(document).scrollTop()).row}t=getCellFromNode(r[0]);if(o==null||t==null){return null}else{return{row:o,cell:t}}}function getCellNodeBox(e,o){if(!cellExists(e,o)){return null}var t=getFrozenRowOffset(e);var r=getRowTop(e)-t;var n=r+options.rowHeight-1;var i=0;for(var l=0;l<o;l++){i+=columns[l].width;if(options.frozenColumn==l){i=0}}var a=i+columns[o].width;return{top:r,left:i,bottom:n,right:a}}function resetActiveCell(){setActiveCellInternal(null,false)}function setFocus(){if(tabbingDirection==-1){$focusSink[0].focus()}else{$focusSink2[0].focus()}}function scrollCellIntoView(e,o,t){scrollRowIntoView(e,t);if(o<=options.frozenColumn){return}var r=getColspan(e,o);internalScrollColumnIntoView(columnPosLeft[o],columnPosRight[o+(r>1?r-1:0)])}function internalScrollColumnIntoView(e,o){var t=scrollLeft+$viewportScrollContainerX.width()-(viewportHasVScroll?scrollbarDimensions.width:0);if(e<scrollLeft){$viewportScrollContainerX.scrollLeft(e);handleScroll();render()}else if(o>t){$viewportScrollContainerX.scrollLeft(Math.min(e,o-$viewportScrollContainerX[0].clientWidth));handleScroll();render()}}function scrollColumnIntoView(e){internalScrollColumnIntoView(columnPosLeft[e],columnPosRight[e])}function setActiveCellInternal(e,o,t,r,n){if(activeCellNode!==null){makeActiveCellNormal();$(activeCellNode).removeClass("active");if(rowsCache[activeRow]){rowsCache[activeRow].rowNode.removeClass("active")}}var i=activeCellNode!==e;activeCellNode=e;if(activeCellNode!=null){var l=$(activeCellNode);var a=l.offset();var s=Math.floor(l.parents(".grid-canvas").offset().top);var d=l.parents(".grid-canvas-bottom").length;if(hasFrozenRows&&d){s-=options.frozenBottom?$canvasTopL.height():frozenRowsHeight}var c=getCellFromPoint(a.left,Math.ceil(a.top)-s);activeRow=c.row;activeCell=activePosX=activeCell=activePosX=getCellFromNode(activeCellNode);if(o==null){o=activeRow==getDataLength()||options.autoEdit}if(options.showCellSelection){l.addClass("active");if(rowsCache[activeRow]){rowsCache[activeRow].rowNode.addClass("active")}}if(options.editable&&o&&isCellPotentiallyEditable(activeRow,activeCell)){clearTimeout(h_editorLoader);if(options.asyncEditorLoading){h_editorLoader=setTimeout((function(){makeActiveCellEditable(undefined,t,n)}),options.asyncEditorLoadDelay)}else{makeActiveCellEditable(undefined,t,n)}}}else{activeRow=activeCell=null}if(!r){trigger(self.onActiveCellChanged,getActiveCell())}}function clearTextSelection(){if(document.selection&&document.selection.empty){try{document.selection.empty()}catch(o){}}else if(window.getSelection){var e=window.getSelection();if(e&&e.removeAllRanges){e.removeAllRanges()}}}function isCellPotentiallyEditable(e,o){var t=getDataLength();if(e<t&&!getDataItem(e)){return false}if(columns[o].cannotTriggerInsert&&e>=t){return false}if(!getEditor(e,o)){return false}return true}function makeActiveCellNormal(){if(!currentEditor){return}trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor});currentEditor.destroy();currentEditor=null;if(activeCellNode){var e=getDataItem(activeRow);$(activeCellNode).removeClass("editable invalid");if(e){var o=columns[activeCell];var t=getFormatter(activeRow,o);var r=t(activeRow,activeCell,getDataItemValueForColumn(e,o),o,e,self);applyFormatResultToCellNode(r,activeCellNode);invalidatePostProcessingResults(activeRow)}}if(navigator.userAgent.toLowerCase().match(/msie/)){clearTextSelection()}getEditorLock().deactivate(editController)}function makeActiveCellEditable(e,o,t){if(!activeCellNode){return}if(!options.editable){throw new Error("SlickGrid makeActiveCellEditable : should never get called when options.editable is false")}clearTimeout(h_editorLoader);if(!isCellPotentiallyEditable(activeRow,activeCell)){return}var r=columns[activeCell];var n=getDataItem(activeRow);if(trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:n,column:r,target:"grid"})===false){setFocus();return}getEditorLock().activate(editController);$(activeCellNode).addClass("editable");var i=e||getEditor(activeRow,activeCell);if(!e&&!i.suppressClearOnEdit){activeCellNode.innerHTML=""}var l=data.getItemMetadata&&data.getItemMetadata(activeRow);l=l&&l.columns;var a=l&&(l[r.id]||l[activeCell]);currentEditor=new i({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:r,columnMetaData:a,item:n||{},event:t,commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus});if(n){currentEditor.loadValue(n);if(o&&currentEditor.preClick){currentEditor.preClick()}}serializedEditorValue=currentEditor.serializeValue();if(currentEditor.position){handleActiveCellPositionChange()}}function commitEditAndSetFocus(){if(getEditorLock().commitCurrentEdit()){setFocus();if(options.autoEdit){navigateDown()}}}function cancelEditAndSetFocus(){if(getEditorLock().cancelCurrentEdit()){setFocus()}}function absBox(e){var o={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:$(e).outerWidth(),height:$(e).outerHeight(),visible:true};o.bottom=o.top+o.height;o.right=o.left+o.width;var t=e.offsetParent;while((e=e.parentNode)!=document.body){if(e==null)break;if(o.visible&&e.scrollHeight!=e.offsetHeight&&$(e).css("overflowY")!="visible"){o.visible=o.bottom>e.scrollTop&&o.top<e.scrollTop+e.clientHeight}if(o.visible&&e.scrollWidth!=e.offsetWidth&&$(e).css("overflowX")!="visible"){o.visible=o.right>e.scrollLeft&&o.left<e.scrollLeft+e.clientWidth}o.left-=e.scrollLeft;o.top-=e.scrollTop;if(e===t){o.left+=e.offsetLeft;o.top+=e.offsetTop;t=e.offsetParent}o.bottom=o.top+o.height;o.right=o.left+o.width}return o}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(!activeCellNode){return}trigger(self.onActiveCellPositionChanged,{});if(currentEditor){var e=getActiveCellPosition();if(currentEditor.show&&currentEditor.hide){if(!e.visible){currentEditor.hide()}else{currentEditor.show()}}if(currentEditor.position){currentEditor.position(e)}}}function getCellEditor(){return currentEditor}function getActiveCell(){if(!activeCellNode){return null}else{return{row:activeRow,cell:activeCell}}}function getActiveCellNode(){return activeCellNode}function getTextSelection(){var e=null;if(window.getSelection){var o=window.getSelection();if(o.rangeCount>0){e=o.getRangeAt(0)}}return e}function setTextSelection(e){if(window.getSelection&&e){var o=window.getSelection();o.removeAllRanges();o.addRange(e)}}function scrollRowIntoView(e,o){if(!hasFrozenRows||!options.frozenBottom&&e>actualFrozenRow-1||options.frozenBottom&&e<actualFrozenRow-1){var t=$viewportScrollContainerY.height();var r=hasFrozenRows&&!options.frozenBottom?e-options.frozenRow:e;var n=r*options.rowHeight;var i=(r+1)*options.rowHeight-t+(viewportHasHScroll?scrollbarDimensions.height:0);if((r+1)*options.rowHeight>scrollTop+t+offset){scrollTo(o?n:i);render()}else if(r*options.rowHeight<scrollTop+offset){scrollTo(o?i:n);render()}}}function scrollRowToTop(e){scrollTo(e*options.rowHeight);render()}function scrollPage(e){var o=e*numVisibleRows;var t=scrollTop+options.rowHeight-1;scrollTo((getRowFromPosition(t)+o)*options.rowHeight);render();if(options.enableCellNavigation&&activeRow!=null){var r=activeRow+o;var n=getDataLengthIncludingAddNew();if(r>=n){r=n-1}if(r<0){r=0}var i=0,l=null;var a=activePosX;while(i<=activePosX){if(canCellBeActive(r,i)){l=i}i+=getColspan(r,i)}if(l!==null){setActiveCellInternal(getCellNode(r,l));activePosX=a}else{resetActiveCell()}}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function navigateTop(){navigateToRow(0)}function navigateBottom(){navigateToRow(getDataLength()-1)}function navigateToRow(e){var o=getDataLength();if(!o)return true;if(e<0)e=0;else if(e>=o)e=o-1;scrollCellIntoView(e,0,true);if(options.enableCellNavigation&&activeRow!=null){var t=0,r=null;var n=activePosX;while(t<=activePosX){if(canCellBeActive(e,t)){r=t}t+=getColspan(e,t)}if(r!==null){setActiveCellInternal(getCellNode(e,r));activePosX=n}else{resetActiveCell()}}return true}function getColspan(e,o){var t=data.getItemMetadata&&data.getItemMetadata(e);if(!t||!t.columns){return 1}var r=t.columns[columns[o].id]||t.columns[o];var n=r&&r.colspan;if(n==="*"){n=columns.length-o}else{n=n||1}return n}function findFirstFocusableCell(e){var o=0;while(o<columns.length){if(canCellBeActive(e,o)){return o}o+=getColspan(e,o)}return null}function findLastFocusableCell(e){var o=0;var t=null;while(o<columns.length){if(canCellBeActive(e,o)){t=o}o+=getColspan(e,o)}return t}function gotoRight(e,o,t){if(o>=columns.length){return null}do{o+=getColspan(e,o)}while(o<columns.length&&!canCellBeActive(e,o));if(o<columns.length){return{row:e,cell:o,posX:o}}return null}function gotoLeft(e,o,t){if(o<=0){return null}var r=findFirstFocusableCell(e);if(r===null||r>=o){return null}var n={row:e,cell:r,posX:r};var i;while(true){i=gotoRight(n.row,n.cell,n.posX);if(!i){return null}if(i.cell>=o){return n}n=i}}function gotoDown(e,o,t){var r;var n=getDataLengthIncludingAddNew();while(true){if(++e>=n){return null}r=o=0;while(o<=t){r=o;o+=getColspan(e,o)}if(canCellBeActive(e,r)){return{row:e,cell:r,posX:t}}}}function gotoUp(e,o,t){var r;while(true){if(--e<0){return null}r=o=0;while(o<=t){r=o;o+=getColspan(e,o)}if(canCellBeActive(e,r)){return{row:e,cell:r,posX:t}}}}function gotoNext(e,o,t){if(e==null&&o==null){e=o=t=0;if(canCellBeActive(e,o)){return{row:e,cell:o,posX:o}}}var r=gotoRight(e,o,t);if(r){return r}var n=null;var i=getDataLengthIncludingAddNew();if(e===i-1){e--}while(++e<i){n=findFirstFocusableCell(e);if(n!==null){return{row:e,cell:n,posX:n}}}return null}function gotoPrev(e,o,t){if(e==null&&o==null){e=getDataLengthIncludingAddNew()-1;o=t=columns.length-1;if(canCellBeActive(e,o)){return{row:e,cell:o,posX:o}}}var r;var n;while(!r){r=gotoLeft(e,o,t);if(r){break}if(--e<0){return null}o=0;n=findLastFocusableCell(e);if(n!==null){r={row:e,cell:n,posX:n}}}return r}function gotoRowStart(e,o,t){var r=findFirstFocusableCell(e);if(r===null)return null;return{row:e,cell:r,posX:r}}function gotoRowEnd(e,o,t){var r=findLastFocusableCell(e);if(r===null)return null;return{row:e,cell:r,posX:r}}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigateRowStart(){return navigate("home")}function navigateRowEnd(){return navigate("end")}function navigate(e){if(!options.enableCellNavigation){return false}if(!activeCellNode&&e!="prev"&&e!="next"){return false}if(!getEditorLock().commitCurrentEdit()){return true}setFocus();var o={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1};tabbingDirection=o[e];var t={up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext,home:gotoRowStart,end:gotoRowEnd};var r=t[e];var n=r(activeRow,activeCell,activePosX);if(n){if(hasFrozenRows&&options.frozenBottom&n.row==getDataLength()){return}var i=n.row==getDataLength();if(!options.frozenBottom&&n.row>=actualFrozenRow||options.frozenBottom&&n.row<actualFrozenRow){scrollCellIntoView(n.row,n.cell,!i&&options.emulatePagingWhenScrolling)}setActiveCellInternal(getCellNode(n.row,n.cell));activePosX=n.posX;return true}else{setActiveCellInternal(getCellNode(activeRow,activeCell));return false}}function getCellNode(e,o){if(rowsCache[e]){ensureCellNodesInRowsCache(e);try{if(rowsCache[e].cellNodesByColumnIdx.length>o){return rowsCache[e].cellNodesByColumnIdx[o][0]}else{return null}}catch(t){return rowsCache[e].cellNodesByColumnIdx[o]}}return null}function setActiveCell(e,o,t,r,n){if(!initialized){return}if(e>getDataLength()||e<0||o>=columns.length||o<0){return}if(!options.enableCellNavigation){return}scrollCellIntoView(e,o,false);setActiveCellInternal(getCellNode(e,o),t,r,n)}function setActiveRow(e,o,t){if(!initialized){return}if(e>getDataLength()||e<0||o>=columns.length||o<0){return}activeRow=e;if(!t){scrollCellIntoView(e,o||0,false)}}function canCellBeActive(e,o){if(!options.enableCellNavigation||e>=getDataLengthIncludingAddNew()||e<0||o>=columns.length||o<0){return false}var t=data.getItemMetadata&&data.getItemMetadata(e);if(t&&typeof t.focusable!=="undefined"){return!!t.focusable}var r=t&&t.columns;if(r&&r[columns[o].id]&&typeof r[columns[o].id].focusable!=="undefined"){return!!r[columns[o].id].focusable}if(r&&r[o]&&typeof r[o].focusable!=="undefined"){return!!r[o].focusable}return!!columns[o].focusable}function canCellBeSelected(e,o){if(e>=getDataLength()||e<0||o>=columns.length||o<0){return false}var t=data.getItemMetadata&&data.getItemMetadata(e);if(t&&typeof t.selectable!=="undefined"){return!!t.selectable}var r=t&&t.columns&&(t.columns[columns[o].id]||t.columns[o]);if(r&&typeof r.selectable!=="undefined"){return!!r.selectable}return!!columns[o].selectable}function gotoCell(e,o,t,r){if(!initialized){return}if(!canCellBeActive(e,o)){return}if(!getEditorLock().commitCurrentEdit()){return}scrollCellIntoView(e,o,false);var n=getCellNode(e,o);var i=columns[o];var l=!!(options.editable&&i&&i.editor&&options.suppressActiveCellChangeOnEdit);setActiveCellInternal(n,t||e===getDataLength()||options.autoEdit,null,l,r);if(!currentEditor){setFocus()}}function commitCurrentEdit(){var e=getDataItem(activeRow);var o=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var t=currentEditor.validate();if(t.valid){if(activeRow<getDataLength()){var r={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(e,this.serializedValue);updateRow(this.row);trigger(self.onCellChange,{command:"execute",row:this.row,cell:this.cell,item:e,column:o})},undo:function(){this.editor.applyValue(e,this.prevSerializedValue);updateRow(this.row);trigger(self.onCellChange,{command:"undo",row:this.row,cell:this.cell,item:e,column:o})}};if(options.editCommandHandler){makeActiveCellNormal();options.editCommandHandler(e,o,r)}else{r.execute();makeActiveCellNormal()}}else{var n={};currentEditor.applyValue(n,currentEditor.serializeValue());makeActiveCellNormal();trigger(self.onAddNewRow,{item:n,column:o})}return!getEditorLock().isActive()}else{$(activeCellNode).removeClass("invalid");$(activeCellNode).width();$(activeCellNode).addClass("invalid");trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:t,row:activeRow,cell:activeCell,column:o});currentEditor.focus();return false}}makeActiveCellNormal()}return true}function cancelCurrentEdit(){makeActiveCellNormal();return true}function rowsToRanges(e){var o=[];var t=columns.length-1;for(var r=0;r<e.length;r++){o.push(new Slick.Range(e[r],0,e[r],t))}return o}function getSelectedRows(){if(!selectionModel){throw new Error("SlickGrid Selection model is not set")}return selectedRows.slice(0)}function setSelectedRows(e,o){if(!selectionModel){throw new Error("SlickGrid Selection model is not set")}if(self&&self.getEditorLock&&!self.getEditorLock().isActive()){selectionModel.setSelectedRanges(rowsToRanges(e),o||"SlickGrid.setSelectedRows")}}function sanitizeHtmlString(e){var o=options.sanitizer||function(e){return e.replace(/(\b)(on\S+)(\s*)=|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;)(\/*)(script|script defer)(.*)(&gt;|&gt;">)/gi,"")};return typeof e==="string"?o(e):e}this.debug=function(){var e="";e+="\n"+"counter_rows_rendered:  "+counter_rows_rendered;e+="\n"+"counter_rows_removed:  "+counter_rows_removed;e+="\n"+"renderedRows:  "+renderedRows;e+="\n"+"numVisibleRows:  "+numVisibleRows;e+="\n"+"maxSupportedCssHeight:  "+maxSupportedCssHeight;e+="\n"+"n(umber of pages):  "+n;e+="\n"+"(current) page:  "+page;e+="\n"+"page height (ph):  "+ph;e+="\n"+"vScrollDir:  "+vScrollDir;alert(e)};this.eval=function(expr){return eval(expr)};$.extend(this,{slickGridVersion:"2.4.44",onScroll:new Slick.Event,onBeforeSort:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderRowMouseEnter:new Slick.Event,onHeaderRowMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onFooterRowCellRendered:new Slick.Event,onFooterContextMenu:new Slick.Event,onFooterClick:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onBeforeFooterRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onBeforeAppendCell:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsDrag:new Slick.Event,onColumnsResized:new Slick.Event,onColumnsResizeDblClick:new Slick.Event,onBeforeColumnsResize:new Slick.Event,onCellChange:new Slick.Event,onCompositeEditorChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,onAutosizeColumns:new Slick.Event,onBeforeSetColumns:new Slick.Event,onRendered:new Slick.Event,onSetOptions:new Slick.Event,registerPlugin,unregisterPlugin,getPluginByName,getColumns,setColumns,getColumnIndex,updateColumnHeader,setSortColumn,setSortColumns,getSortColumns,autosizeColumns,autosizeColumn,getOptions,setOptions,getData,getDataLength,getDataItem,setData,getSelectionModel,setSelectionModel,getSelectedRows,setSelectedRows,getContainerNode,updatePagingStatusFromView,applyFormatResultToCellNode,render,reRenderColumns,invalidate,invalidateRow,invalidateRows,invalidateAllRows,updateCell,updateRow,getViewport:getVisibleRange,getRenderedRange,resizeCanvas,updateRowCount,scrollRowIntoView,scrollRowToTop,scrollCellIntoView,scrollColumnIntoView,getCanvasNode,getUID,getHeaderColumnWidthDiff,getScrollbarDimensions,getHeadersWidth,getCanvasWidth,getCanvases,getActiveCanvasNode,setActiveCanvasNode,getViewportNode,getViewports,getActiveViewportNode,setActiveViewportNode,focus:setFocus,scrollTo,cacheCssForHiddenInit,restoreCssFromHiddenInit,getCellFromPoint,getCellFromEvent,getActiveCell,setActiveCell,setActiveRow,getActiveCellNode,getActiveCellPosition,resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor,getCellNode,getCellNodeBox,canCellBeSelected,canCellBeActive,navigatePrev,navigateNext,navigateUp,navigateDown,navigateLeft,navigateRight,navigatePageUp,navigatePageDown,navigateTop,navigateBottom,navigateRowStart,navigateRowEnd,gotoCell,getTopPanel,setTopPanelVisibility,getPreHeaderPanel,getPreHeaderPanelLeft:getPreHeaderPanel,getPreHeaderPanelRight,setPreHeaderPanelVisibility,getHeader,getHeaderColumn,setHeaderRowVisibility,getHeaderRow,getHeaderRowColumn,setFooterRowVisibility,getFooterRow,getFooterRowColumn,getGridPosition,flashCell,addCellCssStyles,setCellCssStyles,removeCellCssStyles,getCellCssStyles,getFrozenRowOffset,setColumnHeaderVisibility,sanitizeHtmlString,getDisplayedScrollbarDimensions,getAbsoluteColumnMinWidth,init:finishInitialization,destroy,getEditorLock,getEditController});init()}$.extend(true,window,{Slick:{Grid:SlickGrid}})})(jQuery)}}]);
//# sourceMappingURL=9142.38666818a55cfaef1121.js.map?v=38666818a55cfaef1121